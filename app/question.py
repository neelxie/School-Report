embedded_json = []

BuyiLaban= [{"Category":"Animal","Subcategory":"Chicken","Question_id":12092,"Language":"English","Location of farmer":"Moroto District","Question":"Which medicine is used to prevent dizziness in poultry","Answer":"Dizziness is one of the signs  manifested by most of diseases affecting chicken , I advise the farmers to always contact the veterinary personnel of your area who will visit your farm , look at the birds and advise you on the right drugs to use ."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12107,"Language":"English","Location of farmer":"Kikuube","Question":"How many times do you feed chicks a day?","Answer":"A farmer has to ensure that feeds are always in the feed troughs during  feeding of chicks , so that  chicks can eat or feed adlibly for proper growth and healthy . Farmers should avoid limiting feeding and starving chicks or chicken  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12108,"Language":"English","Location of farmer":"Nansana","Question":"Why do chicken sometimes eat less feeds","Answer":"Chicken can eat less feed because they might be sick and also they can eat less feed because of too much heat stress."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12109,"Language":"English","Location of farmer":"Kikuube","Question":"Why type of feeds do we feed birds of meat in poultry day one","Answer":"A farmer is supposed to feed one day old broiler chicks on broiler starter feed or mash because it contains high level of protein (22-23%)."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12110,"Language":"English","Location of farmer":"Kikuube","Question":"How many kgs do we need to feed 100 chicks? A day","Answer":"They can eat about 4.76kgs of feeds "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12111,"Language":"English","Location of farmer":"Kikuube","Question":"Do we feed the chicks of day one the same food with 2 months chicken","Answer":"No , one day old chicks are fed on starter feeds and then two months old chicken are fed on growers feeds ."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12112,"Language":"English","Location of farmer":"Kikuube","Question":"Why do we change food, if we change food per stage?","Answer":"Because nutrient demand especially protein or energy is determined by the age of the birds , for example chicks are fed on starter feed which  contain high protein (21-23%) compared to growers and layers feeds "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12113,"Language":"English","Location of farmer":"Kikuube","Question":"How do we keep the feeds safe and nutritious?","Answer":"Farmers are advised to keep chicken feeds in a cool dry place , in a store with leak proof roof and rodent free. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12114,"Language":"English","Location of farmer":"Kikuube","Question":"How many litters of water is needed foe 100 chicks a day?","Answer":"100 chicks will require  approximately  4.86litres of water per day ."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12115,"Language":"English","Location of farmer":"Kikuube","Question":"Which concentrates are needed to boost the chickens fast?","Answer":"Ferrmers are advised to feed their chicken or birds on a well balanced diet or feeds which contain all nutrients like proteins , carbohydrates, vitamins , minerals and fats in the right proportions if they need their birds to grow fast and healthy "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12116,"Language":"English","Location of farmer":"Kikuube","Question":"Are the greens\/ grass needed as a suplus food in poultry meat?","Answer":"Yes , greens or vegetables are good to chicken because they provide nutrients like  vitamins or  roughage which are important for proper growth of chicken "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12117,"Language":"English","Location of farmer":"Kikuube","Question":"If greens\/grass are required which nutrients can bring in chicken? Especially in 'poultry meat' and eggs may be","Answer":"Greens or vegetables contain nutrients such as vitamins , roughage , protein , some carbohydrates and minerals which are important for growth and development "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12119,"Language":"English","Location of farmer":"Kikuube","Question":"Whats the standard temperature of a brooder ?","Answer":"The temperature for a brooder varies according to the age of the chicks , at week one the temperature should be 95 Ferenheight and then from week 4-5 old the temperature is reduced to 75Ferenheight .In conclusion the temperature is reduced as chicks grow up  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12120,"Language":"English","Location of farmer":"Kikuube","Question":"How do I keep the temperature, I mean should it be day and night, or just at night where there is coldness or some times when its rainning?","Answer":"The temperature is adjusted depending on the conditions in the brooder , it's increased during cold until optimum temperature is attained and it's reduced during hot day until suitable temperature for proper growth of chicks is attained "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12121,"Language":"English","Location of farmer":"Kikuube","Question":"What are the sources of temperatures?","Answer":"A farmer can use , a charcoal stove , pressure lump or heat lump , hot water radiators , pots containing glowing charcoal and electricity or electric bulbs all these can act as heat source for the brooder "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12122,"Language":"English","Location of farmer":"Kikuube","Question":"How should I light the brooder, i.e should it be dark or light?","Answer":"You need to put some light in the brooder house to enable chicks to see and feed during the night and also put heat sources to regulate brooder temperature "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12123,"Language":"English","Location of farmer":"Kikuube","Question":"Which type of lights should we use, artificial like the touch or bulbs or it should be natural like the sun","Answer":"A farmer can use artificial light like electric bulbs , solar lights ,  a chargeable electric lump or a kerosene lump ,  any  of these can work.The artificial lights can be used during night and then natural light from the sun during day time "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12124,"Language":"English","Location of farmer":"Kikuube","Question":"If its artificial light, how about in the noon time where there in natural light of the sun?","Answer":"Switch or put off artificial lights during day time because the sun is enough to provide light during day time "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12125,"Language":"English","Location of farmer":"Kikuube","Question":"What happens when the power goes off in a brooder at night and there is no source pf light?","Answer":"When electricity goes off then you can improvise with a kerosene lump , candles or a chargeable electric lumpy or touch "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12126,"Language":"English","Location of farmer":"Kikuube","Question":"How should we set the housing, i.e should it be enclosed or it should be half way and the upper part should be the mesh? I hve seen some fully enclosed with bricks and others are half build with bricks and the upper part is mesh?","Answer":"A poultry house should be constructed in such a way that , the wall is raised about 1-1.5m with bricks or mud , then the remaining space about 5-6Ft is closed or fitted with wire mesh for ventation purpose  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12127,"Language":"English","Location of farmer":"Kikuube","Question":"Are cages recomendable in poultry meat?","Answer":"Actually cage system  of poultry production is not recommended nowdays because the system abuses the welfare of birds since chicken or birds are not free to express or exhibit their innate behaviors like exercising , scratching , etc "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12128,"Language":"English","Location of farmer":"Kikuube","Question":"How do we treat the chicks?","Answer":"Chicks should be handled with a lot of care since they are too delicate , you have to ensure that the brooder hygiene and sanitation is good and the temperature is at the optimum, in case of any disease signs contact a veterinary personnel of your area to assist you.Once managenent is good then mortalities are reduced  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12130,"Language":"English","Location of farmer":"Kikuube","Question":"Do we inject medicine in chickens or its through ingestion?","Answer":"Actually most of medications in poultry are administered through water such that birds or chicken can drink and get treated .But never give your chicken drugs without recommendation of your local veterinary personnel  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12131,"Language":"English","Location of farmer":"Kikuube","Question":"How often should we vaccinate the chicks?","Answer":"Chicks are vaccinated following a vaccination schedule which is  normally provided by the breeder or your local area veterinary personnel , during vaccination a farmer should try as much as possible to adhere to the vaccination schedule or timetable "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12132,"Language":"English","Location of farmer":"Kikuube","Question":"Why do we change feeds on diffrent levels whats the importance of changing, i.e why is it not constant from day one to 2 months especially in poultry meat","Answer":"Feeds are changed because each stage of growth or age of chicken requires different levels and types of nutrients , for example chicks require high  proteins in the feeds than the growers and layers. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12133,"Language":"English","Location of farmer":"Kikuube","Question":"When is the chicken ready for consumption i.e after how long am I supposed to sell starting from day one chick in poultry meat","Answer":"Under good husbandry management , Broilers are supposed to be sold off at weeks 5-6.Once Broilers reach market age , they should all be sold off and restock new ones "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12134,"Language":"English","Location of farmer":"Kikuube","Question":"How do you set the floor? Should it be concrete? And why do they apply coffee husks?","Answer":"The floor of a poultry house should be made of concrete to prevent scratching activities of chicken , litter of coffee husks is normally put purposely to provide chicken or birds with wormth and also to absorb moisture from the faeces of the birds making it dry to avoid diseases like coccidiosis ."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12135,"Language":"English","Location of farmer":"Kikuube","Question":"If coffee husks not recomendable in poultry house, whats the best material to put in the house, or we should live it as a floor?","Answer":"Besides use of coffee husks as litter , a farmer can also use wood shavings or sawdust , all these materials have ability to provide wormth to the birds and absorb moisture from the faeces of the  birds "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12136,"Language":"English","Location of farmer":"Kikuube","Question":"Are the chicken in the house, I mean those not free range not stressed?","Answer":"Normally chicken under deep litter system of production have less or no stress because they have enough care in terms of feeding and treatment.However, birds kept  under free range system of production are too much stressed because they walk long distances looking for food and they have no any medication given to them , "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12137,"Language":"English","Location of farmer":"Kikuube","Question":"If they are stressed, what should we do? To reduce the stress while not in free range","Answer":"Afarmer should try to supplement them with a well balanced feeds , should also prevent and controll diseases by vaccination and treating the sick chicken in order to reduce stress and mortality ."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12138,"Language":"English","Location of farmer":"Kikuube","Question":"What are the bad vices in chicken?","Answer":"Chicken vices are bad behaviors practiced or shown by birds normally managed under deep litter system of production .These vices include, cannibalism , toe pecking , feather and wing pecking , egg eating and vent pecking. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12139,"Language":"English","Location of farmer":"Kikuube","Question":"What causes those bad vices in chicken?","Answer":"Poultry vices are caused by boredomness of birds in the house , heat stress in the poultry house can trigger cannibalism , innadequated space or overcrawding triggers fighting , poor ventilation and mixing different age groups of chicken together triggers bulling of young birds by the old ones "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12140,"Language":"English","Location of farmer":"Kikuube","Question":"How do know that this chick or chicken is sick?","Answer":"The sick birds will always show abnormal signs or behaviors like, loss of appetite, the bird will have ruffled feathers on the body , drooping wings , strings of mucus from the mouth and nostrils , coughing and sneezing, the bird becomes dull , the bird becomes too weak and unable to walk , pale combs and wattles , diarrhoea and etc.Once you observe these signs then you should know that the birds are sick ."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12142,"Language":"English","Location of farmer":"Kikuube","Question":"How do you prevent other chicken may be the local ones which are free ranged from accessing the house?","Answer":"You can prevent them by fencing using a chain link wire such that the poultry house is kept within the fence  and also  by keeping doors of a poultry house always closed "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12143,"Language":"English","Location of farmer":"Kikuube","Question":"Is it okay to mix the broillers with local chicks in the same house?","Answer":"Infact it's not recommended or advisable to mix Broilers with local breeds of chicken because Broilers have different nutrient requirements and also they are too prone to infections .So each breed of birds should be kept and managed seperately to avoid disease transmission especially from the local birds to the broilers "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12144,"Language":"English","Location of farmer":"Kikuube","Question":"Assume we have a rooster in broilers, can it crossbreed with local chicken and they give birth?","Answer":"Yes it is possible for a  broiler rooster or cock to mate with the local hens and the local hen can be able to lay fertilized eggs which are hatchable "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12145,"Language":"English","Location of farmer":"Kikuube","Question":"What are the main protective gears that we can use in and around the poultry house to prevent diseases?","Answer":"Practices and biosecurity measures used in the poultry house to prevent disease transmission inludes the following ; Disinfection of tools and equipment used in the poultry house using virukil or chlorine , putting or installing foot bath at the exists and entrances of the poultry house or at the gates , ensure good hygiene and sanitation in the poultry house , avoid wetness in the poultry house , vaccinate birds and adhere to vaccination schedule , dispose off all dead birds properly by burying or burning and isolate sick birds immediately to prevent spread of diseases to healthy chicken "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12146,"Language":"English","Location of farmer":"Moroto","Question":"Do we have any respiratory diseasea in poultry?","Answer":"Yes,  there are many common respiratory diseases of poultry such as infectious Bronchitis , infectious Coryza, Newcastle and mycoplasms "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12147,"Language":"English","Location of farmer":"Moroto","Question":"Where do we get the market for our birds, I mean is it possible to get someone who can buy like 200 chicken ready for meat?","Answer":"It is possible to get the market of birds by conducting the market survey ,because most of poultry products are consumed by street vendors who roast chicken locally and also by owners of supermarkets in moroto town .Afarmer should visit and talk to these people and make them aware that he or she has chicken for sell  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12158,"Language":"English","Location of farmer":"Kikuube","Question":"What is the average lifespan of chicken?","Answer":"For example a layer bird has average life span of about 2-2.5 years "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12159,"Language":"English","Location of farmer":"Kikuube","Question":"At what age do eggs begin to lay eggs","Answer":"Layer chicken or birds begin laying eggs at 18-19 weeks of age . "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12160,"Language":"English","Location of farmer":"Kikuube","Question":"Why have my eggs stopped laying eggs","Answer":"Hens can stop laying eggs when they are sick , can stop because they are not feeding well , can also be because they are not given enough feeds , Feeding wrong feeds like giving layers birds growers feeds instead of layers feeds and lastly heat stress can make  birds to stop laying "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12161,"Language":"English","Location of farmer":"Kikuube","Question":"Will a double yorked egg develop into twin chicks","Answer":"No , double yolked eggs can hatch but one chick will be big and strong but the second chick will be too small and weak , in most cases those weak  chicks normally die "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12162,"Language":"English","Location of farmer":"Kikuube","Question":"Are Eggs will blood spots safe for eating?","Answer":"No , eggs containing blood or blood stains are not suitable for human consumption because they are spoiled or are stale .Such eggs should be discarded  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12163,"Language":"English","Location of farmer":"Kikuube","Question":"What causes blood spots in eggs","Answer":"Blood sports are mostly caused by infections especially bacterial infections like salmonellosis or collibacillosis "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12164,"Language":"English","Location of farmer":"Kikuube","Question":"How long will table eggs stay safe","Answer":"Eggs can stay for about 2-3weeks before getting spoiled if not kept in the refrigerator , but can stay up to 3 -4 months if kept in the refrigerator "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12168,"Language":"English","Location of farmer":"Moroto District","Question":"What are some of the components of a spray race","Answer":"Components of a spray race includes , a pump or generator , nozzles , crush and acaricide tank or drum "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12171,"Language":"English","Location of farmer":"Moroto District","Question":"What are qualities of good poultry house and structures","Answer":"A good poultry house should be properly ventilated , it should have enough space to accomodate birds , a good poultry house should not have a leaking roof , the floor of a poultry house should be made of concrete and covered by litter , good poultry house should have a store for keeping food and a good poultry house should have a biosecurity unit  , "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12174,"Language":"English","Location of farmer":"Moroto District","Question":"What are some of the materials used during fencing of a farm","Answer":"During fencing , a farmer can use barbed wire , he or she can use nails , fencing poles , a wire strainner for stretching the wire ,V-nails nails for holding a wife firm against the poles and a harmer .  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12177,"Language":"English","Location of farmer":"Kabarole","Question":"How can I manage a brooder","Answer":"A farmer can manage a brooder by ensuring that litter is not caked and wet , brooder should have working lighting equipment , make sure that the heaters are properly working , ensure good hygiene and sanitation in the brooder , the equipments used in the brooder should be properly disinfected , also ensure adequate ventilation  and the roof for a brooder is not leaking "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12195,"Language":"English","Location of farmer":"Gudi Leisure Farm, Najjera","Question":"Where can the feeds be produced from?","Answer":"Poultry feeds can be locally formulated from the farm by the farmer and poultry feeds can also be produced or processed from the factory for commercial purpose by the manufacturers  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12198,"Language":"English","Location of farmer":"Mbarara","Question":"How do I prevent malnutrition in chicken?","Answer":"A farmer can prevent manutrution in chicks by feeding chicks on a well balanced starter feed and feeding the chicks adequately  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12199,"Language":"English","Location of farmer":"Mbarara","Question":"What breeds of chicken are good for egg laying?","Answer":"They include ; Lehman brown , gold brown and Bovach white etc."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12200,"Language":"English","Location of farmer":"Mbarara","Question":"What are the benefits of free range poultry farming?","Answer":"Advantages of free range system of poultry production are, Free range is cheap compared to cage system , chicken reared under free range are resistant to most common diseases of poultry , Free range system allows chicken to exercise enough since birds move freely and also free range allows birds to eat insects and also feed on green vegetation ."},{"Category":"Animal","Subcategory":"Chicken","Question_id":12201,"Language":"English","Location of farmer":"Mbarara","Question":"How do I manage the vice of egg eating in chickens?","Answer":"A farmer can manage egg eating by debeaking birds or cutting the beaks to make them short and blunt "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12202,"Language":"English","Location of farmer":"Mbarara","Question":"How do I manage any disease outbreaks on my poultry farm?","Answer":"Disease outbreak can be managed by first Isolating sick birds from healthy ones and then subject them to treatment , secondly vaccinate all health birds using  appropriate vaccine , remove the litter in house and disinfect the house , replace new litter after disinecting the house and then continue monitoring the situation until it's normal "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12203,"Language":"English","Location of farmer":"Mbarara","Question":"What is the best feed ratio for optimal growth and egg production?","Answer":"The best feed for optimal growth of birds is a well balanced growers feeds and lastly the best feed for increased egg production is a well balance layers feed  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12217,"Language":"English","Location of farmer":"Mbarara","Question":"What are the recommended vaccination schedules for different poultry breeds?","Answer":"The recommended vaccination schedule is normally provided by the breeders after buying the chicks , alternatively a farmer can always contact the local veterinary personnel to visit his or her farmer and advise accordingly depending on the doctor's evaluation  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12218,"Language":"English","Location of farmer":"Mbarara","Question":"How do I maintain proper ventilation in poultry housing?","Answer":"Proper ventilation can be maintained by use of a wire mesh fixed in the wall space about 5-6ft high and left open , the ventilation space should not be covered during day and night  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12219,"Language":"English","Location of farmer":"Mbarara","Question":"What are the signs of stress or illness in poultry, and how should I address them?","Answer":"Disease signs include , lose of appetite, unsteady gait , dullness , coughing and sneezing , drooping wings of the bird , strings of mucus will be observed hanging around the mouth and nostrils , diarrhoea and the birds looks sleepy and isolated .Once a farmer observes any of those signs should immediately seek the assistance from the local veterinary personnel . "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12220,"Language":"English","Location of farmer":"Mbarara","Question":"What steps can I take to improve eggshell quality?","Answer":"The egg shell quality can be improved by calcium and phosphurous minerals in the layers feeds of the laying birds "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12221,"Language":"English","Location of farmer":"Mbarara","Question":"How can I effectively manage waste produced by my poultry farm?","Answer":"A farmer can effectively manage the waste by regularly collecting the wastes , composit it using a pit and then transfer and apply  the manure to the crop fields to boost crop production "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12222,"Language":"English","Location of farmer":"Mbarara","Question":"How can I prevent common poultry diseases and maintain a healthy flock?","Answer":"Common poultry diseases can be prevented by vaccinating birds or chicken and adhering to vaccination schedule  , by ensuring high level of biosecurity and proper feeding of chicken on well balanced feeds "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12231,"Language":"English","Location of farmer":"Mbarara","Question":"What are the key factors to consider when constructing a poultry house?","Answer":"Key factors to consider when constructing poultry house are , Ventilation should be adequate , the housing space should also be enough to avoid overcrawding of birds or chicken , the roof of a poultry house should not leak, the floor should be made of concrete and covered with good litter like coffee husks, the house should also have a biosecurity unit and lastly , the house should have a store for keeping feeds and other equipment used in the poultry house  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12246,"Language":"English","Location of farmer":"Kabarole","Question":"What food is good for a chicken to grow faster","Answer":"A well balanced growers feed is the best feed used for growing birds or chicken "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12247,"Language":"English","Location of farmer":"Kabarole","Question":"What can I feed my chickens to increase egg production","Answer":"A farmer should feed his or her chicken on a well balanced layers feeds to increase egg production "},{"Category":"Animal","Subcategory":"Chicken","Question_id":12248,"Language":"English","Location of farmer":"Kabarole","Question":"What is the medicine for fast growth of chicken","Answer":"Most poultry feed manaufacturers add growth hormones to poultry feeds to enhance growth or for faster growth of chicken "}]
GodfreySeruwu= [{"Category":"Crop","Subcategory":"Mango","Question_id":10020,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What is the mode of survival and spread of anthracnose disease","Answer":"Anthracnose fungi occur primarily on leaves and twigs. On trees, these fungi overwinter in infected twigs or dead leaf litter. How the disease spreads: The fungi produce numerous microscopic spores that spread via splashing rain or irrigation water to new growth where they germinate, entering leaves and newly expanded twigs"},{"Category":"Crop","Subcategory":"Mango","Question_id":10021,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What management practices should a farmer consider to control anthracnose disease","Answer":"Anthracnose can be managed by cultural means by pruning all infected branches; sanitation by collecting and removing all fallen leaves and twigs, planting resistant varieties and spraying with fungicides"}]
FranciBalinda= [{"Category":"Crop","Subcategory":"Tomatoes","Question_id":5658,"Language":"English","Location of farmer":"Ngora","Question":"What signs does a farmer realize on a tomato plant affected by cucumber mosaic disease?","Answer":"Yellowish patches or green and yellow mottling\/foldings\/curl on leaves,distorted and reduced size in leaves,stunted plant growth, reduced yield, distorted fruits"},{"Category":"Crop","Subcategory":"Carrots","Question_id":11963,"Language":"English","Location of farmer":"Moroto","Question":"How long does the root of the carrots penetrate the soil?","Answer":"The length of a carrot ranges between 6-9 inches. but this may vary from variety to variety and the growing conditions and management practices"},{"Category":"Crop","Subcategory":"Tomatoes","Question_id":11965,"Language":"English","Location of farmer":"Moroto","Question":"My tomatoes after flowering started aborting them, what could be the problem?","Answer":"the problem majorly is as a result of 2 components, nutrient defficiency and water stress.others include poor management practices and lack of pollinators"},{"Category":"Crop","Subcategory":"Tomatoes","Question_id":11985,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"How is mulching important in tomato growth?","Answer":"mulching plays an important role in Tomato growing. Mulching help to preseving water in the soil. mulching decay and improve soil fertility. it is advisable to mulch after plantin."},{"Category":"Crop","Subcategory":"Tomatoes","Question_id":11996,"Language":"English","Location of farmer":"Isingiro","Question":"What are the signs and symptoms of fusarium wilt in tomatoes","Answer":"Leaves on infected plants turn yellow and fall. The plant wilts over several days and then dies. A characteristic symptom of fusarium wilt is the reddish-brown discolouration of the water conducting tissue of the stem and roots, seen when these parts are cut with a sharp knife."},{"Category":"Crop","Subcategory":"Tomatoes","Question_id":12011,"Language":"English","Location of farmer":"Madi Okollo District","Question":"My tomatoes has end rot on fruits, what could be the cause and how to treat it effectively?","Answer":"Blossom end rot is caused by Calcium defficiency. it can be solved by applying calcium based fertilizers."},{"Category":"Crop","Subcategory":"Tomatoes","Question_id":12016,"Language":"English","Location of farmer":"Madi Okollo District","Question":"I would like to venture in commercial vegetable production, what are the recommended chemicals to be used?","Answer":"chemicals are not realy recommended. they are used as the last resort due to their misuse. It is recomended that farmers use the IPM (INTEGRATED PEST MANAGEMENT). This involves Biological, cultural and physical methods which are basically management practices."},{"Category":"Crop","Subcategory":"Sukuma wiiki","Question_id":12017,"Language":"English","Location of farmer":"Madi Okollo District","Question":"How long after spraying chemicals will the crop be safe for human and animal consumption?","Answer":"post Harvest Interval.PHI.This is the period taken by the plant to assimilate and dilute the chemical that has been sprayed. PHI varies from chemical to chemical. It is always between 7-21days.This is because of the active ingridient in the chemical and and the mode of application"},{"Category":"Crop","Subcategory":"Egg plant","Question_id":12019,"Language":"English","Location of farmer":"Moroto","Question":"How deep should be the seeds of eggplant when planting","Answer":"seeds of egg plants are very tiny seed, planting the may be very risky as they  might be over covered or planted deeper than right. if you would like to plant direct seed, put the seed at a depth of two centimeters. but always raise the seedlings in a nursery bed or seedling trays."},{"Category":"Crop","Subcategory":"Vegetables","Question_id":12096,"Language":"English","Location of farmer":"Kikuube","Question":"Why are vegetable seedlings raised in a nursery bed?","Answer":"Vegetables have very small seeds, for that reason there is a need to raise seedlings in a nursery bed which is a designated place that is reserved moniterd to see seeds germinate in to seedlings"},{"Category":"Crop","Subcategory":"Vegetables","Question_id":12099,"Language":"English","Location of farmer":"Kikuube","Question":"How can I prepare a seedbed?","Answer":"Select the proper area for preparing nursery bed having well drained fertile loamy soil rich in organic matter and sunny situation. Mark out the area required for nursery. Dig the soil about 25-30 cm deep with the help of a hoe. Remove weeds, weed roots, tree stamps and stones etc. Level the land with the help of rake. If the soil is heavy clay or silt then mix sand at the rate of 4-5 kg per sq. metre. After this spread well decomposed FYM (Farm Yard Manure) at the rate of 5-6 kg per sq. metre. Fertilizers like urea, single super phosphate and potassium chloride at the rate of 200-250 g per sq. metre. the after saw your Carrots seed. Carrots are tubbers so they are thinned but not transplanted"},{"Category":"Crop","Subcategory":"Vegetables","Question_id":12151,"Language":"English","Location of farmer":"Moroto","Question":"When should I prepare my seed bed?","Answer":"one should prepare a seed bed after determining the type and size of seed to be planted.Not all seeds should be planted in the seed bed. but only those that are small in size."},{"Category":"Crop","Subcategory":"Carrots","Question_id":12152,"Language":"English","Location of farmer":"Moroto","Question":"What is the procedure of preparing a good bed for carrots?","Answer":"Select the proper area for preparing nursery bed having well drained fertile loamy soil rich in organic matter and sunny situation. Mark out the area required for nursery. Dig the soil about 25-30 cm deep with the help of a hoe. Remove weeds, weed roots, tree stamps and stones etc. Level the land with the help of rake. If the soil is heavy clay or silt then mix sand at the rate of 4-5 kg per sq. metre. After this spread well decomposed FYM (Farm Yard Manure) at the rate of 5-6 kg per sq. metre. Fertilizers like urea, single super phosphate and potassium chloride at the rate of 200-250 g per sq. metre. the after saw your Carrots seed. Carrots are tubbers so they are thinned but not transplanted"},{"Category":"Crop","Subcategory":"Tomatoes","Question_id":12307,"Language":"English","Location of farmer":"Kamwenge, Uganda","Question":"How do we prepare nursery bed for tomatoes.","Answer":"Select the proper area for preparing nursery bed having well drained fertile loamy soil rich in organic matter and sunny situation. Mark out the area required for nursery. Dig the soil about 25-30 cm deep with the help of a Hoe. Remove weeds, weed roots,tree stamps and stones etc. Level the land with the help of rake. If the soil is heavy clay or silt then mix sand at the rate of 4-5 kg per sq. metre. After this spread well decomposed FYM (Farm Yard Manure) at the rate of 5-6 kg per sq. metre. Fertilizers like urea, single super phosphate and potassium chloride at the rate of 200-250 g per. metre. "}]
JanetNkozire= [{"Category":"Animal","Subcategory":"Pigs","Question_id":10297,"Language":"English","Location of farmer":"Uganda","Question":"How many kilograms of maize brand does one month piglet","Answer":"A one month piglet easts aboout 500g"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10300,"Language":"English","Location of farmer":"Uganda","Question":"What are the observable characteristics for a healthy piglet","Answer":"the piget is active, has alot of appetite, its droppings are nomal, no standing hair"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10302,"Language":"English","Location of farmer":"Uganda","Question":"How do we prevent ecto parasites in piglets","Answer":"We can prevent ecto parasites by spraying "},{"Category":"Animal","Subcategory":"Pigs","Question_id":10303,"Language":"English","Location of farmer":"Uganda","Question":"How often do we spray? I.e in a month how many times?","Answer":"Spraying can be done twice a month"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10304,"Language":"English","Location of farmer":"Uganda","Question":"Which type of medicine or sprays should we use?","Answer":"Tone type of medicine used is Nucidol"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10305,"Language":"English","Location of farmer":"Uganda","Question":"Should we use deep tanks or use of spraying cans? Which is best for pigs?","Answer":"A spraying can is the best "},{"Category":"Animal","Subcategory":"Pigs","Question_id":10306,"Language":"English","Location of farmer":"Uganda","Question":"Why do we vaccinate pigs?","Answer":"We vaccinate pigs to control diseases from attacking our pigs "},{"Category":"Animal","Subcategory":"Pigs","Question_id":10307,"Language":"English","Location of farmer":"Uganda","Question":"What are the examples of diseases in pigs","Answer":"African swine fever, Coccidiosis,Swine Dysentery,Respiratory Diseases"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10308,"Language":"English","Location of farmer":"Uganda","Question":"How can we prevent the diseases in pigs?","Answer":"By vaccinating the pigs, providing the pigs with a well balanced dite and proper cleaning, "},{"Category":"Animal","Subcategory":"Pigs","Question_id":10309,"Language":"English","Location of farmer":"Uganda","Question":"What are the signs and symptoms of a sick pig","Answer":"loss of appetite, rough hair coat, dirraheoa, paralysis, Sunken Eyes, Hunched Over, Difficulty Breathing (Labored breath or continuous coughing) Sudden Weight Loss and Dehydration"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10310,"Language":"English","Location of farmer":"Uganda","Question":"Why do we need to do in order to limit acess to the farm?","Answer":"To prevent and control diseases outbreaks in the farm"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10311,"Language":"English","Location of farmer":"Uganda","Question":"What are the materials of fencing, i.e which materials are recommendable for fencing in the piggery farm","Answer":"page wire with high tensile of 13.5 gauge wire, panels, and wood"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10312,"Language":"English","Location of farmer":"Uganda","Question":"Why do we keep records in piggery project?","Answer":"It helps farmers track and manage their operations effectively, make informed decisions, and optimize their farming practices for better outcomes"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10313,"Language":"English","Location of farmer":"Uganda","Question":"What are the best method for breeding in pigs?","Answer":"Artificial Insemination AI is the est breeeding method for pigs"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10314,"Language":"English","Location of farmer":"Uganda","Question":"What are the advantages of artificial insemination?","Answer":"It increases the efficiency of bull usage, it decreases the inbreeding, It is cost-effective, It increases the potential for genetic selection,technique increases the safety of animals,It decreases the transmission of disease, A.I. technique helps in the diagnosis of male infertility and Allied techniques"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10315,"Language":"English","Location of farmer":"Uganda","Question":"What are the disadvantages of artificial insemination in pigs?","Answer":"Accurate detection of heat cycles is crucial for successful insemination, Poor heat detection can result in delays in conception, Skilled inseminators are required to perform the procedure correctly, emphasizing the need for proper training."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10316,"Language":"English","Location of farmer":"Uganda","Question":"How do you select the breed, i.e genetic assessment","Answer":"You select the breed basing on heritability and genetic correlations, Progeny testing and accuracy of selection, "},{"Category":"Animal","Subcategory":"Pigs","Question_id":10317,"Language":"English","Location of farmer":"Uganda","Question":"Where should one get the market for pigs on a large scale. I.e some one to buy like 20pigs or piglets at once.","Answer":"One should join any farmer group inorder to get market for his or her produce "},{"Category":"Animal","Subcategory":"Pigs","Question_id":10319,"Language":"English","Location of farmer":"Uganda","Question":"What are the possible risks that a line in piggery farming?","Answer":"Possible risks include; attack of african swine out break at the farm, thefts of the pigs"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10321,"Language":"English","Location of farmer":"Uganda","Question":"Assume its a big piggery farm project that is based in rearing for pork production, how do you manage cash flow?","Answer":"You can manage cahs flow by record keeping every thing "},{"Category":"Animal","Subcategory":"Pigs","Question_id":10322,"Language":"English","Location of farmer":"Uganda","Question":"How do you manage employees in a farm?","Answer":"Management can be done by assigning everyone what to do in a spaced time "},{"Category":"Animal","Subcategory":"Pigs","Question_id":10324,"Language":"English","Location of farmer":"Uganda","Question":"What are the safest mode of transporting the pig from a farm to the pork joint or another farm without injuries","Answer":"Safest mode of transporting is by use of a car "}]
RichardLumu= [{"Category":"Animal","Subcategory":"Pigs","Question_id":9908,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What is expected weight of a large white pig when mature","Answer":"If well fed and genetically efficient a mature large white boar can weigh 105 and a sow approximately weigh 90 to 100 kgs"},{"Category":"Animal","Subcategory":"Pigs","Question_id":9909,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What is the estimated time for large white to be mature","Answer":"Maturity is attained at 8 months for a large white."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9911,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What factors should farmers consider when selecting a site for pig housing","Answer":"The site should be put on a well drained place."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9912,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What are the components of a pig house","Answer":"These include the roof,walls and the floor."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9913,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What are the space requirements for a pig house","Answer":"It should be 3 metres x 3 metres"},{"Category":"Animal","Subcategory":"Pigs","Question_id":9914,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"How should a farmer set up a fermented bed technology","Answer":"It is arranged by assembling tree trunks as the first layer,straw as a second layer, amixture of Agricultural lime and sub soil as a third layer and saw dust as the final layer."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9915,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What are the importance of feeds in piggery units","Answer":" Feeds are essential because they are the driving force to nourish the growth of pigs from one stage to another, which results into farmers profit and hence the profitability of the piggery enterprise."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9916,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What are the major feed requirements for pigs","Answer":"These are divided into,carbohdrates, for supply of energy,Proteins, for building body blocks,Vitamins for disease prevention and immunity buid up,Minerals for skelton formation and balancing of metabolism and water for transportation of nutrients to different parts of the body and for regulating temperature plus removal of toxic substances though panting and urination."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9917,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What type of feed should be given to baby piglets","Answer":"Piglets are fed on creep feed."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9918,"Language":"English","Location of farmer":"Ngora","Question":"What are the signs of ill health in pigs","Answer":"Signs of ill health in pigs include,Dullness,lossof appetite,staggering among others."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9919,"Language":"English","Location of farmer":"Ngora","Question":"What are the best management practices in pig farm","Answer":"These include,Good housing,Proper feeding,regular deworming,hygiene  and other veterinary care as need arises"},{"Category":"Animal","Subcategory":"Pigs","Question_id":9920,"Language":"English","Location of farmer":"Ngora","Question":"How do parasites and worms affect the health of pigs","Answer":"Parasites and worms do compete for nutrients with the pigs affected, transmit diseases to pigs and reduces farmers profits."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9921,"Language":"English","Location of farmer":"Ngora","Question":"How can farmers manage to control the effects of parasites and worms in pigs","Answer":"Parasites and worms can be controlled through regular and timely deworming,Spraying and observing hygiene on farms.  "},{"Category":"Animal","Subcategory":"Pigs","Question_id":9922,"Language":"English","Location of farmer":"Ngora","Question":"What are the clinical signs of worm infestation","Answer":"Signs of worm infestation include, swollen abdomens standing hair, diarrhea and worm segments in stool of affected animals plus stanted growth."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9923,"Language":"English","Location of farmer":"Ngora","Question":"What is the treatment given to pigs to cure them from internal parasites","Answer":"Pigs can be dewormed by oral method through administering  drugs through the mouth and by injecting into the body."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9924,"Language":"English","Location of farmer":"Ngora","Question":"What causes african swine fever","Answer":"African swine fever is caused by a virus"},{"Category":"Animal","Subcategory":"Pigs","Question_id":9931,"Language":"English","Location of farmer":"Ngora","Question":"Explore the complexities surrounding water management in agriculture focusing on efficient irrigation methods water conservation and impact of water security on global food production","Answer":"There is a lot of water lost during the wet season as ru off yet it would be utilized efficiently if stored in resourvours for irrigation during times of scarcity in the dry season to boost crop production or purified and utilized in different ways ."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9933,"Language":"English","Location of farmer":"Ngora","Question":"What ways can farmers control transmissible gastroenteritis","Answer":"This can be done by carrying out regular deworming."},{"Category":"Animal","Subcategory":"Pigs","Question_id":9949,"Language":"English","Location of farmer":"Ngora","Question":"What are breeding techniques to improve livestock genetic","Answer":"Regular sellection for a desired trait or traits."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10056,"Language":"English","Location of farmer":"Ngora","Question":"What equipment a farmer needs when starting up a piggery farm","Answer":"Tools like, hoes, pangas and pick axe "},{"Category":"Animal","Subcategory":"Pigs","Question_id":10094,"Language":"English","Location of farmer":"Uganda","Question":"What is required for one to begin to piggery farm?","Answer":"One needs Land, labour and enterprenuership."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10138,"Language":"English","Location of farmer":"Ngora","Question":"What are the best housing and space requirements for raising pigs","Answer":"Agood pig house should be with a well drained and concreate floor, at least 3 metres x 3 metres wide, should be leak proof and with well constructed walls to protect pigs from wild animals and extremes of temperatures."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10139,"Language":"English","Location of farmer":"Ngora","Question":"What is the I dea feed composition and nutrition for the different stages of pig","Answer":"Depending on stage of growth,each category or stage of growth has different nutrional and quantity requirents, Piglets 1 month to 3 months require a lot of proteins for body building, 4 to 8 Months Need alot of mineral supplimentation and energy as they prepare themselves for reproduction purposes"},{"Category":"Animal","Subcategory":"Pigs","Question_id":10140,"Language":"English","Location of farmer":"Ngora","Question":"How do I prevent diseases and maintain good health in my pig herd","Answer":"Practice good hygiene,ensure biosecurity  measures are in place and adhered to, avoid in breeding, Provide good nutrition and vaccinate animals on schedule."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10142,"Language":"English","Location of farmer":"Ngora","Question":"How can I optimize piglet care and management","Answer":"This can be done by practicing hygiene at the farm,Proer nutrition, proper breeding and timely veterinary care."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10143,"Language":"English","Location of farmer":"Ngora","Question":"What are the waste management strategies for pig","Answer":"Use of manure to generate biogas,Practising Indegenius Micro Organism rearing of pigs, Proper disposal of manure treatment and subsquent utiliisation."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10144,"Language":"English","Location of farmer":"Ngora","Question":"How do I control the odor and environmental impact of pig farming","Answer":"Odour reduction in pig production can be achieved through various ways,By practising Indegenius micro organism sytsem of pig production,Incorporating Diatomous Earth in pig diets reduces the smell of the droppings."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10146,"Language":"English","Location of farmer":"Ngora","Question":"What are the best practices for humane and ethical pig slaughter","Answer":"All pigs should be slaughtered at disgnated and authorised places and pork has to be inspected by competent vets before public consumption."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10164,"Language":"English","Location of farmer":"Kampala","Question":"How can one optimize irrigation and water management in a farm?","Answer":"This can be done by carrying out proper water harvesting,subsquent storage and proper utilization."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10175,"Language":"English","Location of farmer":"Wakiso","Question":"What is piggery in farming","Answer":"Is the practice of looking after pigs with the aim of earning an income."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10177,"Language":"English","Location of farmer":"Wakiso","Question":"What is the gestation period of pig","Answer":"Gestation takes 3 months, 3 weeks and 3 days."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10185,"Language":"English","Location of farmer":"Wakiso","Question":"What is the name of a male pig","Answer":"A male pig is called a boar."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10223,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"Why do pigs make noise while mating","Answer":"It is not true that pigs make noise while mating,actually the noise is usually before the act of mating due to misunderstanding between the male and the female pig and this is mainly when the female heat signs are not yet evident,but during the real mating or copulation, the animals are silent."},{"Category":"Crop","Subcategory":"Pigs","Question_id":10277,"Language":"English","Location of farmer":"Kabarole","Question":"Which type of feeds I given to pigs in that they can be of a good quality","Answer":"Pigs should be given well formulated feeds, that meet body requirements like energy,vitamins ,minerals, proteins."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10289,"Language":"English","Location of farmer":"Uganda","Question":"How do you set a stricture for pigs","Answer":"Depending on ones financial stand,there are structures that are built in concreate and others with locally available simple materials, but which ever way ensure that the structure will give confort to pigs by protecting them from extremes of temperatures and other dangers."},{"Category":"Animal","Subcategory":"Pigs","Question_id":10290,"Language":"English","Location of farmer":"Uganda","Question":"How do you feed 2 months piglets?","Answer":"Twice a day on good formulated feeds."}]
MartinOkojo = [{"Category":"Animal","Subcategory":"Chicken","Question_id":11794,"Language":"English","Location of farmer":"Butambala","Question":"What vaccines need to be given to one day old chics?","Answer":"One day old chicks need to be given Marek's vaccine."},{"Category":"Crop","Subcategory":"Chicken","Question_id":11795,"Language":"English","Location of farmer":"Butambala","Question":"What is the profit margin for broiler chicken given the high feed prices, what is the estimate?","Answer":"estimated to be 1,170,180 this variable is attributed to high prices for chicks and feeds from the market."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11799,"Language":"English","Location of farmer":"Mbarara","Question":"How can a farmer manage coffee wilt before spreading to the rest of the plantation?","Answer":"through cutting down the affected plants and burn."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11800,"Language":"English","Location of farmer":"Mbarara","Question":"Does poultry business need a side business to look after the expenses at the farm?","Answer":"Yes, through carrying out crop farming so as to cut costs of buying feeds."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11819,"Language":"English","Location of farmer":"Mbarara","Question":"At what stage is the immunization of chicks against malex is done?","Answer":"Day one immediately from the hatchery"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11820,"Language":"English","Location of farmer":"Mbarara","Question":"How productive is the local breed compared to the exotic ones?","Answer":"a local broody hen lays up to 72eggs, while a local non broody lays up to 102 eggs and a free range hen starts laying at the age of 22 weeks and while looking at the cost of feeding the local they are relatively cheaper compared to other exotic birds."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11821,"Language":"English","Location of farmer":"Kikuube","Question":"How can a farmer manage poultry diseases","Answer":"Through having strict biosecurity measures at the farm.\nProper hygiene.\nGood nutrition."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11822,"Language":"English","Location of farmer":"Isingiro","Question":"How do we mix feeds for Layers","Answer":"14.3kgs of broken maize,24.3kgs of brand,18=6kgs of wheat pellar,14.3kgsof wheat bran,15.7kgs of sunflower cake,6.4 kgs of soya cake,2.9kgs of lime.,8.1kgs of bone meal."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11823,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"What is brooding in poultry farming","Answer":"this refers to the period immediately after hatch when special care and attention must be given to the chicks to ensure their health and survival."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11826,"Language":"English","Location of farmer":"Kiryandongo","Question":"What is the process of making IMO in poultry enterprise","Answer":"this is actually done through fermenting the materials from plants and fruits materials with sugar which is then diluted in water."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11830,"Language":"Luganda","Location of farmer":"Kyotera","Question":"Lwaki enkoko ziziba amaaso,Era nsobola kuziyambantya?","Answer":"Obulwadde bwa Fowl pox buvaako amaaso okuzimba mu nkoko. Kebera obubonero obulala okukakasa kino era okozese eddagala eriragiddwa okujjanjaba kino."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11831,"Language":"English","Location of farmer":"Kiryandongo","Question":"What vaccine is being administered in a day old chick?","Answer":"Marek's vaccine and usually administered immediately from the hatchery."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11835,"Language":"English","Location of farmer":"Kabarole","Question":"Most common diseases of poultry","Answer":"Poultry is most commonly attacked by viral and bacterial diseases"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11836,"Language":"English","Location of farmer":"Eastern Uganda","Question":"What are the biosecurity measures in poultry reared in Namisindwa?","Answer":"perimeter chain link,foot bath, protective gear, good hygiene and others"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11837,"Language":"English","Location of farmer":"Kyotera","Question":"Define the term brooding, as applied in poultry","Answer":"refers to the special care and attention which must be given to the chicks to ensure their health and survival."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11839,"Language":"English","Location of farmer":"Tororo","Question":"What is the vaccination schedule for broiler birds in eastern region","Answer":"It starts with Marek's vaccine from the incubator day one."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11840,"Language":"English","Location of farmer":"Madi Okollo","Question":"I have a 4 months kroilers, they are vomiting and feeling weak.What could be the disease has affected them and how can it prevented","Answer":"can be caused by viral diseases, fungal diseases,liver disease toxicity in the feeds.how to treat is through change of the diet,treat them to tackle underlying disease"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11845,"Language":"English","Location of farmer":"Kabale","Question":"How do we formulate a broiler feed below 1 month","Answer":"140g of tryptophan,20g of lysine ,20g methionine,140g,of threonine and 100g of enzymes"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11847,"Language":"English","Location of farmer":"Wakiso","Question":"How do I feed broilers from day one until the time for sellling","Answer":"for a farmer to have a strong flock he or she should follow this feeding schedule., from Day one to fourteen days he or she should give starter mash and each chicks will eat 1kg., from day 21 to 35 they should give post finisher mash or pellet and each chick eats 2kgs, then the last diet is finisher mash or pellet."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11848,"Language":"English","Location of farmer":"Kiryandongo","Question":"What are the different diseases that attack poultry?","Answer":"under fungal diseases we have mycoplasmosis, cryptococcosis,candidiasis, aspergillosis,under bacterial is we have calibacillosis,fowl cholera and others then under viral we have Newcastle, gumboro,fowl typhoid and infectious bronchitis and others"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11850,"Language":"English","Location of farmer":"Kabarole","Question":"How many times are we supposed to immunise day 1chicks up to a month","Answer":"We are supposed to immunise four times in a month."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11854,"Language":"English","Location of farmer":"Arua","Question":"How can someone identify a bird which is suffering from new castle?","Answer":"Gasping, convulsions, bright green diarrhea,lose of appetite, paralysis, coughing and others"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11861,"Language":"English","Location of farmer":"Kikuube","Question":"How many times should I vaccinate my poultry birds before selling","Answer":"this depends on the breed afarmer chosen to rear if it's broilers four times, but if it's local eight times."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11863,"Language":"English","Location of farmer":"Kasanda","Question":"How to mix feeds in poutry chicks of week two","Answer":"soya mael 30g, 140g of tryptophan,20g of lysine,20g of methionine, 140g of threonine and 100g of enzymes."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11864,"Language":"English","Location of farmer":"Namisindwa","Question":"Why does my bird have fallen wings?","Answer":"that's a sign of new castle disease."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11867,"Language":"English","Location of farmer":"Kassanda","Question":"What vaccine can I use to vaccinate my chicks of day one","Answer":"Chicks of day one are given Marek's vaccine."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11869,"Language":"English","Location of farmer":"Kiryandongo","Question":"What are the causes of Newcastle disease?","Answer":"it's marjoly caused by a virus called para myco and also poor biosecurity measures."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11871,"Language":"English","Location of farmer":"Namisindwa","Question":"Why do my birds fail to hatch eggs?","Answer":"failure of the ovum to be fertilized., failure of the fertilized ovum to develop, inheritable low hatchability, high incubation temperature and also low turning off the eggs in a day."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11873,"Language":"English","Location of farmer":"Tororo","Question":"One week broiler birds passing greenish dropping, what could be the problem","Answer":"that's a sign of Newcastle infection in the flock."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11874,"Language":"English","Location of farmer":"Tororo","Question":"My local chicken have dropping wings and are not eating well. What could be the problem","Answer":"That's a sign of disease infestation in your flock"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11875,"Language":"English","Location of farmer":"Tororo","Question":"What is the vaccination schedule for local chicken in eastern Uganda","Answer":"Day one Marek's, Day 7 New Castle, day 14 gumboro one,day 21 gumboro booster two, day 28 infectious barsal disease, day 60 fowl typhoid, Day 75 fowl pox and then 90 days New Castle vaccine again then their after every three months New Castle vaccine should be given to the flock."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11876,"Language":"English","Location of farmer":"Kikuube","Question":"What are the steps taken when brooding chicks from day one to 1months","Answer":"clean and disinfect the room before the arrival of the chicks, check the litter must be dry fresh, also make sure you check the fittings, temperature control, Fred and water troughs arrangements is well before the arrival of the chicks."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11879,"Language":"English","Location of farmer":"Amolatar","Question":"Which medicine is given to the birds of 14 days","Answer":"Chicks of 14 days are given Gumboro one.vaccine."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11881,"Language":"English","Location of farmer":"Moroto","Question":"Which diseases mostly affacts poultry","Answer":"viral disease majorly caused by New Castle disease ."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11883,"Language":"English","Location of farmer":"Moroto","Question":"How many kgs of food should I give my chicken in a day","Answer":"Broiler needs not more than 2.2kg of feeds from day one to the eighth week"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11889,"Language":"English","Location of farmer":"Namisindwa","Question":"Whats the simplest remedy for foul cholera?","Answer":"through good biosecurity measures, vaccination and use of antibiotics."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11892,"Language":"English","Location of farmer":"Namisindwa","Question":"Does foul cholera have same signs with foul typhoid?","Answer":"No, the common signs of fowl cholera are sudden death,ruffled reathers, bluish colouration of the wattles and combs,high fever and others where as fowl typhoid has anorexia,high mortality, lose of appetite and others."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11907,"Language":"English","Location of farmer":"Ngora","Question":"How can I manage Newcastle diseases in my poultry farm?","Answer":"strict biosecurity measures and  following the proper vaccination schedule."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11911,"Language":"English","Location of farmer":"Kabale","Question":"What are the signs of gumboro in chicken","Answer":"huddling, dehydration , trembling, poor appetite etc."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11912,"Language":"English","Location of farmer":"Isingiro","Question":"What is the recommended laying percentage for broiler parent stock (Cobb 500)","Answer":"75% uniformity is required in the flock."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11924,"Language":"English","Location of farmer":"Fort Portal, Uganda","Question":"Which type of chicken is the best to rear","Answer":"leghorn, brahma old English game and others."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11925,"Language":"English","Location of farmer":"Jinja","Question":"Which one is the best profitable between layer and broilers?","Answer":"layer farming is much more profitable as compared to broiler farming.but that depends on the mortality which can be caused by viral diseases."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11926,"Language":"English","Location of farmer":"Jinja","Question":"What causes some Chicks to make their heads to face behind without removing it?","Answer":"It can be caused by genetic disorder or vitamin deficiencies."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11927,"Language":"English","Location of farmer":"Jinja","Question":"How many cocks are needed in 100 hens?","Answer":"With a ratio of 1to 10 that means only 10 cocks in 100 females."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11928,"Language":"English","Location of farmer":"Jinja","Question":"What could be right space for 200 birds of 2 months?","Answer":"3m by5m at stock density of 6birds\/ square meter."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11929,"Language":"English","Location of farmer":"Jinja","Question":"After how long do layers becomes off layers?","Answer":"This happens after 18 months of age."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11931,"Language":"English","Location of farmer":"Jinja","Question":"What could be the maximum number of eggs should one hen lay in a period of 1 year?","Answer":"Non broody local lays about 102 eggs in a year."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11932,"Language":"English","Location of farmer":"Jinja","Question":"Broilers should be at what age to be ready for eating or put on market?","Answer":"Five weeks of age by that it's estimated one bird to be weighing about 1.5kgs to 1.8kgs."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11933,"Language":"English","Location of farmer":"Jinja","Question":"Do broilers also lay eggs?","Answer":"They do not lay eggs commercially like layers but parent birds of broiler chickens do lay fertilised eggs. These are known as broiler breeders. Consider parents stock Cobb 500."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11937,"Language":"English","Location of farmer":"Moroto","Question":"How many times should I feed my chickens in aday","Answer":"Layers should be fed two to three times a day"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11938,"Language":"English","Location of farmer":"Moroto","Question":"Which type of feeds should I give to the one day old chicks to two weeks","Answer":"One day old chicks to two weeks old chicks should be fed on starter mash or starter crumble "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11943,"Language":"English","Location of farmer":"Moroto","Question":"Why is it that when hens are laying eggs some eggs are small alsame are big","Answer":"this can be caused by deficiency of some nutrients in the diet, stress of their reproductive system, eviromental conditions, predators and others."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11955,"Language":"English","Location of farmer":"Moroto","Question":"Which vaccines are used for vaccinating one day old chicks","Answer":"Marek's vaccine is always administered immediately from the hatchery."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11956,"Language":"English","Location of farmer":"Moroto","Question":"How often should I be vaccinating my chicken","Answer":"depending on the breed for broilers four times, for local breed eight times."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11957,"Language":"English","Location of farmer":"Moroto","Question":"Which amount of vaccine should I be giving my chicks","Answer":"if you have about five hundred chicks the vaccine should also be given hundred doses "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11958,"Language":"English","Location of farmer":"Moroto","Question":"Why do most chicks die during breeding","Answer":"This can be caused marjoly by two factors,high temperature which results to sticking of the droppings into the vent thus resulting to blockage of vent which aventually results to death,low temperature which results to chilling and pneumonia which most cases present more mortality."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11968,"Language":"English","Location of farmer":"Kabarole","Question":"How should I set a brooder?","Answer":"Clean the brooder, spray or disinfect the unit two weeks prior to receiving the chicks, also introduce a fresh dry litter, check the fittings and temperature in the unit ."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11969,"Language":"English","Location of farmer":"Kabarole","Question":"What makes chicks eyes swollen?","Answer":"Fowl pox disease causes swollen eyes in chicken. Check other signs to confirm this and use the recommended medicine to treat this."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11975,"Language":"English","Location of farmer":"Jinja","Question":"What are the procedures of vaccinating check?","Answer":"The vaccine can be administered through orally, injection or eye drop."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11976,"Language":"English","Location of farmer":"Jinja","Question":"How many times can hens be vaccinated after month of age?","Answer":"Three times, that is for fowl typhoid,fowl pox and then finally Newcastle vaccine."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11977,"Language":"English","Location of farmer":"Jinja","Question":"For how long do eggs spend in a machine for incubation?","Answer":"The duration is twenty one days of incubation."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11978,"Language":"English","Location of farmer":"Jinja","Question":"What could be the best feeds for layers from the day they start to lay eggs?","Answer":"Layer mash \/ pellet is the diet to be served to the flock."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11979,"Language":"English","Location of farmer":"Jinja","Question":"How many grams of feeds do a hen of 1month consume?","Answer":"One month old hen consumes about 40 grams."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11980,"Language":"English","Location of farmer":"Jinja","Question":"What is the best feeds for broilers of 2 days to 7 days?","Answer":"The best feeds for broilers of 2 days to 7 days is Broiler starter crumble."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11981,"Language":"English","Location of farmer":"Jinja","Question":"Which breed is the best for commercial purpose?","Answer":"Almost all the hybrid breeds are good for commercial purposes but most likely connish Cross breeds are the best for commercial purpose."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11982,"Language":"English","Location of farmer":"Jinja","Question":"What are the benefits of vegetables to hens and cocks when given to them?","Answer":"Vegetables are used for vitamins or as supplements to poultry."},{"Category":"Animal","Subcategory":"Turkeys","Question_id":11983,"Language":"English","Location of farmer":"Jinja","Question":"Coccidiosis can also attack turkeys?","Answer":"Yes, it does and the sign is diarrhea in the flock."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11984,"Language":"English","Location of farmer":"Jinja","Question":"How often should one spray the poultry house with disinfectant?","Answer":"At the end of every sale of the batch of the flock."}]
RobertIsabirye = [{"Category":"Animal","Subcategory":"Chicken","Question_id":11282,"Language":"English","Location of farmer":"Moroto","Question":"What are the main causes of the rapid spread of coccidiosis in poultry rearing?","Answer":"The main causes of the rapid spread of coccidiosis in through ingestion of contaminated faeces from sick birds. To avoid the spread of coccidiosis therefore, the farmer should practise strict hygiene. Utensils should be cleaned thoroughly before feed and water free from disease is added. There is a vaccine for protection but it is not readily available on the Ugandan market. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11317,"Language":"English","Location of farmer":"Wakiso","Question":"What could be the cause of cough in chicks of 1 week","Answer":"Cough in chicks of 1 week can be caused by a number of factors: - Diseases for example mycoplasma gallisepticum; infectious bronchitis; OR chronic respiratory disease (CRD). Stress can be a predisposing factor for underlying diease to show up. Birds suffering with respiratory disease should always be isolated from healthy stock to limit spread of the disease since respiratory diseases are usually very contagious in nature. the consult the area vet for a solution."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11318,"Language":"English","Location of farmer":"Wakiso","Question":"What is the cause of birds dehorning?","Answer":"Dehorning in birds is not practical. It is only prectised in mammals for example in cattle and goats. It is carried out to avoid injury to the animal and others on the farm, a dehorned animal is easier  to transport, and a dehorned animal takes less space during thransportation. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11319,"Language":"English","Location of farmer":"Wakiso","Question":"What causes vent prolapse in layers","Answer":"Vent prolapse can be due to: - Large eggs which are oversized; obesity of the layer; double yolked egss; nutritional deficiency especially when the diet lacks minerals especially calcium, magnesium and other minerals; infection for example egg peritonitis which is a fatal infection inside the abdomen."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11320,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"What could be the reason for birds with laying age failing to lay eggs","Answer":"The reasons for birds of laying age failing to lay eggs are: Stress especially emotional stress due to e.g. transposportation; water deprivation; nutritional deficiency as a result of not getting sufficient nutrients in feed; inadequate light in the poultry unit leading to reduction in day length (14 hours of light per day are commended); moulting whereby hens divert protein and energy away from egg production to concentrate on feather growth. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11321,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"How can I avoid egg damage on my poultry farm","Answer":"Egg damage on a poultry farm can be avoided by: avoid overcrowding of the hens, do not disrupt the birds which might result into egg breakages, keep the farm free from disease since some diseases reduce the quality of eggshell. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11322,"Language":"English","Location of farmer":"Mitooma Uganda","Question":"What causes blindness in birds and what treatment can I give to my birds","Answer":"Blindness in birds can be due to: Bacterial infections e.g. salmonella; Fungal infections usually acquired through eating mouldy feed; vitamin A deficiency or inury in one or both eyes. Blindness can be treated by: flushing sterile saline solution, but it is better to consult the vet for  timely and appropriate treatment."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11323,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"What are the effects of ammonia gas in the poultry house","Answer":"The effects of ammonia gas in a poultry house are: gasping, sneezing, nasal discharge, coughing. Ammonia also corrodes  the respiratory tract leading to bacteria infections. This predisposes the birds to many other diseases and also causes severe stress. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11324,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"How many layers should be in one meter squared at laying age","Answer":"There should be 4 to 6 layers of laying age per square metrer. Therefore on average they should be 5 layers per square metre. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11325,"Language":"English","Location of farmer":"Hoima Uganda","Question":"Loss of feathers in breeders birds what causes it","Answer":"Loss of feathers in breeder birds is caused by: Poor diet especially when there is no enough protein, vitamins or minerals inthe diet; parasitism especially mites and lice infestation; during broodness especially if the hen can use its body temperature to keep the eggs at the appropriate body temperature for hatching if the hens are bred for sitting on the eggs by themselves and not by placing the an artificial incubator."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11326,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"What causes the death of birds immediately after debeaking","Answer":"Death of birds immediately after debeaking may be due to too much loss of blood (bleeding) and pain to the birds. Only when carried out badly,then  debeaking can cause death, otherwise it is very rare for death to result from debeaking. It is advisable to employ an experienced person to carry out debeaking. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11327,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"How long does the Cobb 500 broiler breed take to lay","Answer":"The Cobb 500 broiler lays at the age of 26 weeks. Since it was breed as a broiler and not a layer breed, it takes longer that layer breeds to lay eggs. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11328,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"What are the challenges of too much heat in brooding","Answer":"Too much heat in brooding can lead to the following challenges: Dehdration which comes as a result of too much loss of water from the body and due to excessive panting; poor growth; loss of appetite; and increase in mortality.  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11329,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"What causes litter wetness in poultry house","Answer":"Wetness of litter in poultry house may be caused by: diarrhoeal diseases; poor diet and nutrition; and failure to control spilling of water into the litter. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11331,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"What are the types of layer birds we have in Uganda","Answer":"The types of layer birds (chicken) we have in Uganda are: Lehman brown, Gold brown, Harvard white and ISA brown. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11332,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"How best can I transport my birds from the farm to the market without stressing them","Answer":"The best way to transport birds from the farm to the market without stressing them is by placing them in cages or plastic containers. These should be having enough holes on them to allow ventilation. It is also advisable not to crowd birds in one container, othewise they can suffocate and cause deaths to the birds. "},{"Category":"Animal","Subcategory":"Ducks","Question_id":11333,"Language":"English","Location of farmer":"Kampala Uganda","Question":"What causes Newcastle diseases in poultry","Answer":"Newcastle disease in poultry is caused by virulent strains of avian paramyxovirus type 1"},{"Category":"Animal","Subcategory":"Chicken","Question_id":11334,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"What is the recommended brooding temperature in chicken","Answer":"Recommended brooding temperature is set depending on the age of the chicks. As the birds start developing feathers, the temperature is lowered a bit as follows: 0 - 1 week = 33.9 - 35 \u00b0C; week 1 - 2 = 31.1 - 32.2\u00b0C; Week 2 - 3 = 28.3\u00b0 to 29.4\u00b0C."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11336,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"How long should poultry manure take before use in plantations","Answer":"Poultry manure should take a minimum of 3 months before it can be taken to the plantation. It is avdisable however, if possible to wait for 6 months to 1 year. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11337,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"How can we differentiate between female chicks at day one old","Answer":"Female and male chicks at day one old can be differentiated using the feather sexing method as follows: The wing feathers will seem longer or vary in size if the bird is a female; and the male chicks the wing feathers are almost the same lengths. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11338,"Language":"English","Location of farmer":"Kampala Uganda","Question":"What causes vent pecking in poultry","Answer":"Vent pecking is caused by: Too much light in the laying nests; and at times due to boredom; and due to frequent changing of diet of the birds. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11339,"Language":"English","Location of farmer":"Kampala Uganda","Question":"What causes prolapse in chicken broilers","Answer":"Prolpse in broilers is caused by: Calcium deficiency; or holding droppings for too long period causing stress and stretching the cloaca."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11340,"Language":"English","Location of farmer":"Kampala Uganda","Question":"How does age affect the performance of the animal chicken","Answer":"Age affects the performance of chicken in that as the chicken grows it reaches a time when its meat starts becoming very tough "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11345,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"How best can I utilize the wastes like blood, and offals after slaughtering chicken if I dont want to give as per feeds?","Answer":"Wastes like blood and offals after slaughtering chicken if not used to give as per feed can be utilized as follows: They can be used in a biodigester to generate biogas and te slurry generated is used in gardens as organic fertilizer to improve on fertility of te soil. In so doing the biogas is used as a renewable source of energy in cooking, lighting and other uses. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11346,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"What is the recommended weight that should be the desired minimum before slaughtering chicken for marketing?","Answer":"The recommended desired weight before slaughter is 1300 gms.  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11348,"Language":"English","Location of farmer":"Kampala, Uganda","Question":"How best can poultry farmer can minimise on feed costs to feed his chicken in layers farm apart from providing greenish pastures.","Answer":"Apart from providing greenins pastures, Poultry farmer can minimize on feed costs to feed his layer chicken farm   by doing the following: Keeping efficient breeds i feed utilization; mixing whole grain with chicken feed; fermenting the chicken feed, this will provide all bacteria that are good for the gut hence efficient feed utilization; growing on your own some of the feed ingredients; and avoiding overfeeding the flock.  "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11349,"Language":"English","Location of farmer":"Kampala Uganda","Question":"What causes shells eggs in layers","Answer":"Most of the problems associated to shells in layers are attributed to deficiency of minerals especially calcium. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11361,"Language":"English","Location of farmer":"Ngora","Question":"How can pneumonia be controlled by farmers","Answer":"Pneumonia in poultry can be controlled by farmers by: ensuring proper housing with good ventilation and avoiding dampness in the housing units; and .thoroughly cleaning feed and water utensils regularly to avoid cross contamination of feed or bedding supplies. Also, frequently relocate feeders and water dispensers to discourage mould growth. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11386,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What are the reasons for egg breaking and drinking layers in a deep litter-rearing system?","Answer":"The reasons for birds of laying age failing to lay eggs are: Stress especially emotional stress due to e.g. transposportation; water deprivation; nutritional deficiency as a result of not getting sufficient nutrients in feed; inadequate light in the poultry unit leading to reduction in day length (14 hours of light per day are commended); moulting whereby hens divert protein and energy away from egg production to concentrate on feather growth. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11387,"Language":"English","Location of farmer":"Ngora, Uganda","Question":"What preparations should be carried out before the arrival of one-day-old chicks?","Answer":"The following preparations should be carried out before the arrival of one day old chicks: The brooder should be cleaned and all unnecessary items removed; the brooder disinfected at least 14 days before expected arrival of the chicks; start heating the brooder for 24 to 36 hours depending on the outside temperatures. Then on the day of arrival, arrange all the utensils especially the drinkers and feeder and make sure all the lighting and heating devices are all functioning very well. Ensre that there is water soluble glucose to give the chicks on arrival."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11388,"Language":"English","Location of farmer":"Ngora","Question":"What behavioral activities indicate that the chicks are under stress","Answer":"The  behavioural activities that indicate that the birds are under stress are: They are aggressive, feather pecking; peeping loudly and consistently; reduced activity and at times lack of appetite."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11389,"Language":"English","Location of farmer":"Ngora","Question":"How can a farmer manage stress in young chicks","Answer":"A farmer can manage stress in young chicks by: Giving clean fresh water all the time; keeping all utensils clean regularly; Give good nutritive diet; ensure there is enough ventilation in the poultry house; keep away animals e.g. dogs far away from the poultry house; handle the chicks with care as much as possible."},{"Category":"Animal","Subcategory":"Chicken","Question_id":11420,"Language":"English","Location of farmer":"Mbarara","Question":"What causes egg pecking in chickens when using feed concentrates?","Answer":"Egg pecking in chickens when using feed concentrates is caused by:  Insufficient calcium in the diet or weak shells which are as a result os inadequate calcium in the diet; "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11421,"Language":"English","Location of farmer":"Mbarara","Question":"What causes chickens to peck each others behind?","Answer":"Causes of vent pecking in chickens are: Sodium deficiency inthe diet; very bright light in the laying area;  stress to the birds; inadequate nutrients in the diet; overheating; when the feeders and drinkers are left empty; and poor ventiation leading to inadequate aeration in the poultry house. "},{"Category":"Animal","Subcategory":"Chicken","Question_id":11422,"Language":"English","Location of farmer":"Mbarara","Question":"Is it recommended to mix large volumes of chicken feed and store it, if yes what is the preferred storage time?","Answer":"No it is not advisable to mix large volumes of chicken feed and store it especially if it will take long for all of it to be consumed. This is because during storage the feed will deteriorate and lose its quality is kept for more that 2 months. This will lead to development of moulds; poor growth of the birds; malnutrition; and health complications. Feeds should not be stored for more than 2 months once mixed. "}]
IanBenya = [{"Category":"Animal","Subcategory":"animals","Question_id":8440,"Language":"English","Location of farmer":"Uganda","Question":"How can small-scale farmers benefit from integrating livestock like cows, goats, and sheep on their farms?","Answer":"The farmer benefits in different ways, through getting more manure, Better utilization of pastures, fodders due to different way of feeding, e.g. the couws graze and the goat and sheep browse. "},{"Category":"Animal","Subcategory":"Goats","Question_id":11773,"Language":"English","Location of farmer":"Ngora","Question":"How can animal welfare be ensured in agricultural practices","Answer":"Through proper feeding, housing, treatment of diseases and parasites "},{"Category":"Animal","Subcategory":"Cattle","Question_id":11774,"Language":"English","Location of farmer":"Ngora","Question":"What are the key factors to consider in designing optimal housing for livestock","Answer":"Topography, wind direction, accessibility, security, drainage, dstance from the market."},{"Category":"Animal","Subcategory":"Cattle","Question_id":11776,"Language":"English","Location of farmer":"Ngora","Question":"How can farmers effectively manage and prevent diseases in livestock","Answer":"This can be done through proper feeding, Vaccinating, Biosecurity measures, Routine dewarming of animals, Isorating of sick animals and quarantining."},{"Category":"Animal","Subcategory":"Goats","Question_id":11777,"Language":"English","Location of farmer":"Ngora","Question":"What are the breeding techniques and genetic considerations for improving livestock","Answer":"Inbreeding, Crossbreeding, Backcrossing, Outcrossing and pure breeding. Considerations for improving livestock include, breeding for high milking cows, disease resistance, good quality meat and fast growth."},{"Category":"Animal","Subcategory":"Cattle","Question_id":11778,"Language":"English","Location of farmer":"Ngora","Question":"How do different climate and environment impact animal husbandry practices","Answer":"This could result in improper feeding, like during the dry season, there is less pastures for animals to feed on, whereas in rain season, there is a need for routine dewarming for internal parasites on the farm. "},{"Category":"Animal","Subcategory":"Goats","Question_id":11780,"Language":"English","Location of farmer":"Ngora","Question":"How can farmers integrate rotational grazing systems for better pasture management","Answer":"This can be done by padocking the pasture land. "},{"Category":"Animal","Subcategory":"Cattle","Question_id":11842,"Language":"English","Location of farmer":"Lwengo","Question":"What scientific name is given to the disease that is prevented by surmolin in cattle","Answer":"The scientific name of this disease is Anaplasmosis"},{"Category":"Crop","Subcategory":"cocoa","Question_id":4093,"Language":"English","Location of farmer":"Kaberamaido","Question":"can Cocoa also be grown in kaberamaido and if no why","Answer":"Yes, it can be grown there."},{"Category":"Crop","Subcategory":"bananas","Question_id":8262,"Language":"English","Location of farmer":"Isingiro","Question":"How can the Ugandan government and other stakeholders support matooke farmers in Isingiro?","Answer":"By providing them with drought resistant matooke varieties, Give them skills to add value to their matooke during the times of boom harvest, equip them with skills to manage their plantations well. "},{"Category":"Crop","Subcategory":"bananas","Question_id":8263,"Language":"English","Location of farmer":"Kabuyanda","Question":"how can i effeciently use 10 acres of land to plant banana suckers in kabuyanda","Answer":"Sice bananas take 12 months to grow, it is advisable to intercrop the bananas with legumes such as beans, soybean or ground nuts during the growth cycle. As the farmer is waiting to harvest the bananas, they can benefit from the harvest of the legumes. These legumes also help to fix nitrogen in the soil hence improving the soil fertility. They also act as cover crops to protect the soil and sufocate the weeds. "},{"Category":"Crop","Subcategory":"bananas","Question_id":8310,"Language":"Luganda","Location of farmer":"Uganda","Question":"Nsonseka matooke bameka okugasimba ku yiika 50 mu ndagiriro ya minisitule ya uganda eyebyobulimi?","Answer":"Kumabanga ga 3m x3m, wetaga ebitooke 22500 okusimba yiika 50."},{"Category":"Crop","Subcategory":"bananas","Question_id":8392,"Language":"Luganda","Location of farmer":"Rukungiri","Question":"Ndi mulimi e rukungiri era njagala okumanya endwadde ezenjawulo ezikwata matooke.","Answer":"Waliyo Kiwotoka (Banana bacterial wilt disease), kiino kyikwata ebitooke ela, ekitooke kyengela nga kiikyali kitto dala(premature ripening), Endagals zifuka za kyenvu. Waliyo ebilwadde ebilala nga (Fusarium wilt\/Panama disease, Black and Yellow sigatoka)."},{"Category":"Crop","Subcategory":"bananas","Question_id":8393,"Language":"Luganda","Location of farmer":"Uganda","Question":"Buwuka ki obuletera okuwotoka ne bacteria wilt mu matooke era bubonero ki obulaga okuwotoka?","Answer":"Akawuka bakayita  Xanthomonas vasicola pv. musacearum. Kano kekaleta kiwotoak mumatooke. Obubonero (ekitooke kyengela nga kiikyali kitto dala(premature ripening)), Okukala kwempumumpu, Endagals zifuka za kyenvu."},{"Category":"Crop","Subcategory":"bananas","Question_id":8395,"Language":"Luganda","Location of farmer":"Masaka","Question":"Kika kya matooke ki ekiri ku mutindo kyensobola okusimba e Masaka?","Answer":"Osobola okusimba ebitoke bya NARO ebilongosemu (NAROBAN1, NAROBAN2, 3 and 4) Oba okusimba ebitooke ebinansii nga (Kiibuzi, mpologoma, Kisansa) Nga sibilwadde."},{"Category":"Crop","Subcategory":"bananas","Question_id":8492,"Language":"English","Location of farmer":"Ruhama","Question":"What might be the cause of a farmers reduced banana production from 50 bananas per hectare to 30 bananas per day in his Ruhama farm, given that the banana leaves are turning yellow and the stems have lost their usual dark color and how can he go about addressing this issue? Lets approach this step by step.","Answer":"The farner might have been attacked by Banana bacterial wilt disease. This disease has no cure and once the banana plant is affected, then it has to be destroyed. The disease causes yellowing of the leaves and in most cases the premature ripening of the bunches. It spreads in three ways; 1. Through the planting materials e.g the suckers, 2. Through the tools used in the plantation, 3. Through insects that collect nector from the male buds. The farmer can manage the diseas through use of good quality suckers, braking off the male bud when the last cluster has fully formed and disinfecting the tools. A farmer should destrole only the affected plant of the banana mat by catting it down and burning of burying. "},{"Category":"Crop","Subcategory":"bananas","Question_id":8495,"Language":"English","Location of farmer":"Isingiro","Question":"In Isingiro, a farmer applies manure to his banana plantation every two months. If he last manured them on November 8, 2023, on which date should he plan to apply manure to the banana plantation again? Lets approach this step by step.","Answer":"Bananas are perenial crops, a farmer does not need to apply manure in every two months. A farmer should apply manure atleast once at the every end of the growing cycle. Therefore if the farmer last applied manure on November 8,2023, the next application should be November 8 2024."},{"Category":"Crop","Subcategory":"bananas","Question_id":8498,"Language":"English","Location of farmer":"Isingiro","Question":"If a matooke farmer in Isingiro, initially had 100 suckers planted on his farm, and now there are a total of 250 suckers on the farm after workers planted some, how many suckers did the farmers themselves plant?","Answer":"The farmers planted 150 suckers themselves"},{"Category":"Crop","Subcategory":"bananas","Question_id":8613,"Language":"English","Location of farmer":"Kapchorwa","Question":"List five banana plant breeds suitable for dry areas like Kapchorwa region.","Answer":"NARO banana breeds lke (NAROBAN 1, 2, 3, 4) and the FHIA breeds that are drought tolerant."},{"Category":"Crop","Subcategory":"bananas","Question_id":8699,"Language":"English","Location of farmer":"Isingiro","Question":"give 3 farming practices people in Isingiro do to increase matooke produce","Answer":"Manure\/Fertilizer application, Maintaining plant population by desuckering, Manage pests and diseases. "},{"Category":"Crop","Subcategory":"Banana","Question_id":11106,"Language":"English","Location of farmer":"Mbarara","Question":"Can you recommend organic farming practices suitable for banana cultivation?","Answer":"Yes I can. E.g. Using organic manure ensure slow release of nutrients to the bananas. This helps to improve soil health."},{"Category":"Crop","Subcategory":"Banana","Question_id":11712,"Language":"English","Location of farmer":"Wakiso","Question":"What is meant by the term farming","Answer":"Farming is the practice of growing crops, rearing of livestck  and aquatic animals on the farmland."},{"Category":"Crop","Subcategory":"Banana","Question_id":11950,"Language":"English","Location of farmer":"Isingiro","Question":"Why is couch grass a common weed in banana plantations?","Answer":"This is because there is a good micro climate conditions that favour couch grass. And being that cuoch grass is a perennial weed, it would grow better in conditions that favour perennial crops like banana. "},{"Category":"Crop","Subcategory":"Banana","Question_id":12239,"Language":"English","Location of farmer":"Mbarara","Question":"What are the optimal soil conditions for banana cultivation?","Answer":"Soils which are well drained, deep fertile with alot of humus and organic matter. Ther pH range is 6.5 to 7.0"},{"Category":"Crop","Subcategory":"Banana","Question_id":12244,"Language":"English","Location of farmer":"Mbarara","Question":"How do you control pests and diseases in a banana plantation?","Answer":"Through using clean suckers, Using pesticides, Ensuring weed free fields, proper spacing, ensure proper fertilization of the plantation and other management practices. "}]
list_of_expertiz = {
	'BuyiLaban': {'id': 136},'FranciBalinda': {'id': 133},
	'GodfreySeruwu': {'id': 183},'IanBenya': {'id': 200},
	'MartinOkojo': {'id': 139},'JanetNkozire': {'id': 134},
	'RichardLumu': {'id': 182}, 'RobertIsabirye': {'id': 197},
}

derek_list = {'BuyiLaban': BuyiLaban,'FranciBalinda': FranciBalinda,
	'GodfreySeruwu': GodfreySeruwu,'IanBenya': IanBenya,
	'MartinOkojo': MartinOkojo,'JanetNkozire': JanetNkozire,
	'RichardLumu': RichardLumu, 'RobertIsabirye': RobertIsabirye
}

import json

from app.status import (
	HTTP_200_OK,
	HTTP_201_CREATED,
	HTTP_204_NO_CONTENT,
	HTTP_400_BAD_REQUEST,
	HTTP_404_NOT_FOUND,
	HTTP_409_CONFLICT,
)
from flask import Blueprint, request, send_file
from flask.json import jsonify
import pandas as pd
from flask_jwt_extended import get_jwt_identity, jwt_required, verify_jwt_in_request
from app.models import Question, db, User, Answer
import datetime
import random
import os
from os.path import join, dirname, realpath
from io import StringIO
from google.cloud import storage

from sqlalchemy import func, or_, and_, not_, text
from app.helper import admin_required

UPLOADS_PATH = join(dirname(realpath(__file__)), "static/audio_uploads")
DATASET_PATH = join(dirname(realpath(__file__)), "static/dataset")

questions = Blueprint("questions", __name__, url_prefix="/api/v1/questions")

def get_audio_file_content(file_path):
	# file_path = os.path.join(UPLOADS_PATH, filename)
	return send_file(file_path, as_attachment=True)



def format_question(question, language):
	return {
		"id": question.id,
		"sentence": question.sentence,
		"language": question.language,
		"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
		"topics": question.topic,
		"sub_topic": question.sub_topic,
		"category": question.category,
		"animal_crop": question.animal_crop,
		"location": question.location,
		"question_language": language,
		"filename": question.filename,
	}

def jsonify_question(question):
	return {
		"id": question.id,
		"sentence": question.sentence,
		"language": question.language,
		"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
		"topics": question.topic,
		"sub_topic": question.sub_topic,
		"category": question.category,
		"animal_crop": question.animal_crop,
		"location": question.location,
		"filename": question.filename,
		"reviewed": question.reviewed,
		"answered": question.answered
	}

def file_name(file):
	name = file.filename
	file_name, file_extension = os.path.splitext(name)
	return file_name, file_extension

def chanelle(value):
	if int(value) == 6:
		return 5
	try:
		return int(value)
	except ValueError:
		return 1

@questions.route("/", methods=["POST", "GET"])
@jwt_required()
def handle_questions():
	def process_single_question(question_data, current_user):
		sentence = question_data.get("sentence", "")
		language = question_data.get("language", "")
		topic = question_data.get("topic", "")
		sub_topic = question_data.get("sub_topics", "")
		category = question_data.get("category", "")
		animal_crop = question_data.get("sub_category", "")
		location = question_data.get("location", "")
		today = datetime.date.today()

		if language not in ["English", "Luganda", "Runyankole"]:
			return (
				jsonify({"error": "Invalid language selection"}),
				HTTP_400_BAD_REQUEST,
			)

		if not sentence or not language:
			return (
				jsonify(
					{
						"error": "Both sentence and language must be provided for each question"
					}
				),
				HTTP_400_BAD_REQUEST,
			)

		elif Question.query.filter_by(sentence=sentence).first():
			return (
				jsonify({"error": "This question already exists"}),
				HTTP_409_CONFLICT,
			)
		else:
			question = Question(
				sentence=sentence,
				language=language,
				user_id=current_user,
				topic=topic,
				category=category,
				animal_crop=animal_crop,
				location=location,
				sub_topic=sub_topic,
			)
			db.session.add(question)
			db.session.flush()

			num_questions = Question.query.filter_by(user_id=current_user).count()
			today = datetime.date.today()
			questions = (
				Question.query.filter_by(user_id=current_user)
				.filter(func.date(Question.created_at) == today)
				.all()
			)
			todaysQuestions = []
			for question in questions:
				todaysQuestions.append(
					{
						"id": question.id,
						"sentence": question.sentence,
						"language": question.language,
						"created_at": question.created_at,
						"topics": question.topic,
						"sub_topic": question.sub_topic,
						"category": question.category,
						"animal_crop": question.animal_crop,
						"location": question.location,
					}
				)

			return {
				"num_questions": num_questions,
				"questions": todaysQuestions,
			}, HTTP_201_CREATED

	current_user = get_jwt_identity()

	if request.method == "POST":
		data = request.get_json()

		if not data:
			return (
				jsonify({"error": "Invalid or empty JSON data provided"}),
				HTTP_400_BAD_REQUEST,
			)

		if isinstance(data, list): 
			results = []
			for question_data in data:
				result = process_single_question(question_data, current_user)
				results.append(result)
			db.session.commit()
			return jsonify(results), HTTP_201_CREATED
		else:  # If it's a single question
			result = process_single_question(data, current_user)
			db.session.commit()
			return result

	else:
		user = User.query.filter_by(id=current_user).first()
		if user:
			questions = user.questions

			returned_data = []

			if not questions:
				return jsonify({"error": "No data yet"}), HTTP_204_NO_CONTENT

			for question in questions:
				returned_data.append(
					{
						"id": question.id,
						"sentence": question.sentence,
						"language": question.language,
						"created_at": question.created_at,
						"topics": question.topic,
						"sub_topic": question.sub_topic,
						"category": question.category,
						"animal_crop": question.animal_crop,
						"location": question.location,
					}
				)

			return jsonify(returned_data), HTTP_200_OK
		else:
			return jsonify({"error": "User not found"}), HTTP_404_NOT_FOUND


@questions.route("/upload_question", methods=["POST"])
@jwt_required()
def upload_question():
	if "audio" not in request.files:
		return jsonify({"error": "No audio file provided"}), HTTP_400_BAD_REQUEST

	language = request.form.get("language")
	topic = request.form.get("topic", "")
	sub_topic = request.form.get("sub_topics", "")
	category = request.form.get("category", "")
	animal_crop = request.form.get("sub_category", "")
	location = request.form.get("location", "")

	audio = request.files["audio"]

	if audio:
		filename = os.path.join("static", "audio_uploads", audio.filename)
		if os.path.exists(filename):
			return jsonify({"Error": "File with same name already exists"})
		audio.save(filename)

	current_user = get_jwt_identity()
	question = Question(
		language=language,
		user_id=current_user,
		topic=topic,
		sub_topic=sub_topic,
		filename=filename,
		category=category,
		animal_crop=animal_crop,
		location=location,
	)

	db.session.add(question)
	db.session.flush()

	num_questions = Question.query.filter_by(user_id=current_user).count()
	today = datetime.date.today()
	questions = (
		Question.query.filter_by(user_id=current_user)
		.filter(func.date(Question.created_at) == today)
		.all()
	)
	todaysQuestions = []
	for question in questions:
		todaysQuestions.append(
			{
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at,
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"filename": question.filename
			}
		)

	return {
		"num_questions": num_questions,
		"questions": todaysQuestions,
	}, HTTP_201_CREATED


@questions.route("/offline_upload", methods=["POST"])
@jwt_required()
def offline_upload():
	if "file" not in request.files:
		return jsonify({"error": "No metadata file provided"}), HTTP_400_BAD_REQUEST

	if "files" not in request.files:
		return jsonify({"error": "No audio files provided"}), HTTP_400_BAD_REQUEST

	metadata_file = request.files.get("file")
	audio_files = request.files.getlist("files")
	metadata = json.loads(metadata_file.read().decode("utf-8"))

	if not audio_files:
		return jsonify({"error": "No audio files provided"}), HTTP_400_BAD_REQUEST

	if not metadata:
		return jsonify({"error": "Metadata file not provided"}), HTTP_400_BAD_REQUEST

	current_user = get_jwt_identity()

	questions = []
	dup_count = 0
	duplicates = []

	for obj in metadata:
		audio_filename = obj['audio_filePath'].rsplit('.', 1)[0]
		
		for audio in audio_files:
			au  =  file_name(audio)[0]
			
			if audio_filename == au:
				
				filename = os.path.join("static", "audio_uploads", obj["audio_filename"])

				if os.path.exists(filename):
					dup_count += 1
					duplicates.append({"filename": filename})
					return (
						jsonify({"error": "File with the same name already exists"}),
						HTTP_400_BAD_REQUEST,
					)
				audio.save(filename) 		

				if obj:
					question_data = {
						"language": obj.get("language"),
						"topic": obj.get("topic", ""),
						"sub_topic": obj.get("sub_topics", ""),
						"category": obj.get("category", ""),
						"animal_crop": obj.get("sub_category", ""),
						"location": obj.get("location", ""),
						"user_id": current_user,
						"filename": filename,
					}

					question = Question(**question_data)
					questions.append(question)
				else:
					return (
						jsonify(
							{"error": f"No metadata found for audio file: {audio.filename}"}
						),
						HTTP_400_BAD_REQUEST,
					)

	db.session.add_all(questions)
	db.session.commit()

	num_questions = Question.query.filter_by(user_id=current_user).count()
	return (
		jsonify(
			{
				"num_questions": num_questions,
				"duplicate_questions": dup_count,
				"duplicates": duplicates,
			}
		),
		HTTP_200_OK,
	)


@questions.route("/file_upload/", methods=["POST"])
@jwt_required()
def upload_json_file():
	if request.method == "POST":
		file_json = request.files.get("file")
		json_data = json.load(file_json)

		current_user = get_jwt_identity()
		dup_count = 0
		duplicates = []

		for obj in json_data:
			sentence = obj["sentence"]
			language = obj["language"]
			topic = obj.get("topic")
			sub_topic = obj.get("sub_topics")
			category = obj.get("category")
			animal_crop = obj.get("sub_category")
			location = obj.get("location")

			if Question.query.filter_by(sentence=sentence).first():
				dup_count += 1
				duplicates.append({"sentence": sentence})
			else:
				question = Question(
					sentence=sentence,
					language=language,
					user_id=current_user,
					topic=topic,
					sub_topic=sub_topic,
					category=category,
					animal_crop=animal_crop,
					location=location,
				)
				db.session.add(question)
				db.session.commit()

		num_questions = Question.query.filter_by(user_id=current_user).count()

		return (
			jsonify(
				{
					"num_questions": num_questions,
					"duplicate_questions": dup_count,
					"duplicates": duplicates,
				}
			),
			HTTP_200_OK,
		)


@questions.get("/<int:id>")
@jwt_required()
def get_question(id):
	current_user = get_jwt_identity()

	question = Question.query.filter_by(user_id=current_user, id=id).first()

	if not question:
		return jsonify({"message": "Question not found"}), HTTP_404_NOT_FOUND

	return (
		jsonify(
			{
				"id": question.id,
				"language": question.language,
				"sentence": question.sentence,
				"created_at": question.created_at,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
			}
		),
		HTTP_200_OK,
	)

@jwt_required()
@questions.get('/delete-questions')
def delete_questions():
	try:
		questions_to_delete = Question.query.filter(Question.rephrased == "actual", Question.reviewed != True).all()
		
		# for question in questions_to_delete:
		#		Answer.query.filter_by(question_id=question.id).delete()

		# num_deleted = Question.query.filter(Question.rephrased == "actual", Question.reviewed != True).delete()
		num_deleted = len(questions_to_delete)

		db.session.commit()
		return jsonify({'message': f'{num_deleted} questions and associated answers deleted successfully'})
	except Exception as e:
		db.session.rollback()
		return jsonify({'error': 'An error occurred while deleting questions and answers'})


@jwt_required()
@questions.get("/displayall")
def display_questions():
	verify_jwt_in_request()
	curre = get_jwt_identity()
	isadmin = User.query.get(curre)
	page = request.args.get('page', 1, type=int)
	per_page = request.args.get('per_page', 100, type=int)
	questions = Question.query.filter(
		(Question.user_id != isadmin.id)
	).paginate(page=page, per_page=per_page, error_out=False)

	if not questions:
		return jsonify({"message": "No questions yet."}), HTTP_204_NO_CONTENT

	returned_data = []

	for question in questions:
		user = User.query.get(question.user_id)  # Get the user who asked the question
		if user:
			user_name = f"{user.firstname} {user.lastname}"

		returned_data.append(
			{
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"audio": question.filename,
				"user_name": user_name,
			}
		)

	return jsonify(returned_data), HTTP_200_OK


@jwt_required()
@questions.get("/all")
def get_questions():
	current_user = get_jwt_identity()
	isadmin = User.query.get(current_user)
	questions = Question.query.filter(
		(Question.user_id != isadmin.id)
	).all()

	if not questions:
		return jsonify({"message": "No questions yet."}), HTTP_204_NO_CONTENT

	returned_data = []

	for question in questions:
		user = User.query.get(question.user_id)
		if user:
			user_name = f"{user.firstname} {user.lastname}"

		returned_data.append(
			{
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"audio": question.filename,
				"user_name": user_name,
			}
		)

	return jsonify(returned_data), HTTP_200_OK



@jwt_required()
@questions.get("/download")
def download_questions():
	verify_jwt_in_request()
	user_id = get_jwt_identity()
	isadmin = User.query.get(user_id)
	start_date_str = request.args.get('start_date')
	
	if start_date_str:
		try:
			start_date = datetime.datetime.strptime(start_date_str, '%Y-%m-%d')
			questions = Question.query.filter(
				(Question.user_id != isadmin.id) &
				(Question.created_at >= start_date)
			).all()
		except ValueError:
			return jsonify({"message": "Invalid start_date format. Use YYYY-MM-DD."}), HTTP_400_BAD_REQUEST
	else:
		questions = Question.query.filter(
			(Question.rephrased != "actual")
		).all()

	if not questions:
		return jsonify({"message": "No questions yet."}), HTTP_204_NO_CONTENT

	returned_data = []

	for question in questions:
		user = User.query.get(question.user_id)  # Get the user who asked the question
		user_name = None
		if user:
			user_name = f"{user.firstname} {user.lastname}"

		returned_data.append(
			{
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"audio": question.filename,
				"user_name": user_name,
			}
		)
	return jsonify(returned_data), HTTP_200_OK

@jwt_required()
@questions.get("/myqns")
def get_my_questions():
	questions = Question.query.filter(
		(Question.rephrased == "actual")
	).all()

	if not questions:
		return jsonify({"message": "No questions yet."}), HTTP_204_NO_CONTENT

	returned_data = []

	for question in questions:
		user = User.query.get(question.user_id)
		if user:
			user_name = f"{user.firstname} {user.lastname}"

		returned_data.append(
			{
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"user_name": user_name,
				"reviewed":question.reviewed,
				"rephrased": question.rephrased
			}
		)

	return jsonify(returned_data), HTTP_200_OK

@jwt_required()
@questions.get("/top_users")
def top_users_with_most_questions():
	users_with_most_questions = (
		User.query.join(Question, User.id == Question.user_id)
		.group_by(User.id)
		.order_by(db.func.count(Question.id).desc())
		.all()
	)
	top_users_data = []
	for user in users_with_most_questions:
		top_users_data.append(
			{
				"user_id": user.id,
				"location": user.location,
				"firstname": user.firstname,
				"lastname": user.lastname,
				"username": user.username,
				"phone_number": user.phone_number,
				"total_questions": len(user.questions),
			}
		)

	return jsonify(top_users_data), HTTP_200_OK


@jwt_required()
@questions.get("/stats")
# @admin_required
def list_questions():
	verify_jwt_in_request()
	current_user = get_jwt_identity()
	isadmin = User.query.get(current_user)
	all_questions = Question.query.filter(
		(Question.user_id != isadmin.id)
	).all()
	
	#     all_questions = db.sessionQuestion).all()
	total_questions = len(all_questions)
	questions_per_language = (
		db.session.query(Question.language, func.count(Question.id))
		.filter((Question.user_id != isadmin.id))
		.group_by(Question.language)
		.all()
	)
	
	audio_questions = Question.query.filter(Question.filename.isnot(None)).all()

	average_daily_questions = total_questions / (
		Question.query.filter(
			(Question.rephrased != "actual"),
			(Question.user_id != isadmin.id)
			& (Question.created_at >= datetime.date.today())
		).count()
		or 1
	)

	one_week_ago = datetime.date.today() - datetime.timedelta(weeks=1)
	average_weekly_questions = total_questions / (
		Question.query.filter(
			(Question.rephrased != "actual"),
			(Question.user_id != isadmin.id)
			& (Question.created_at >= one_week_ago)
		).count()
		or 1
	)

	#  Calculate average questions per user
	total_users = User.query.count()
	average_questions_per_user = total_questions / (total_users or 1)
	
	plant_question_count = Question.query.filter(
		(Question.user_id != isadmin.id)
		& (func.lower(Question.category) == "crop")
	).count()

	animal_question_count = Question.query.filter(
		(Question.user_id != isadmin.id)
		& (func.lower(Question.category) == "animal")
	).count()

	response_data = {
		"total_questions": total_questions,
		"questions_per_language": [
			{"language": lang, "count": count} for lang, count in questions_per_language
		],
		"average_daily_questions": round(average_daily_questions, 2),
		"average_weekly_questions": round(average_weekly_questions, 2),
		"average_questions_per_user": round(average_questions_per_user, 2),
		"plant_category": plant_question_count,
		"animal_category": animal_question_count,
		"audios": len(audio_questions),
		"questions": [
			{
				"id": question.id,
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
			}
			for question in all_questions
		],
	}

	return jsonify(response_data), HTTP_200_OK


@questions.route("/random_question", methods=["GET"])
@jwt_required()
def random_question_and_add_answer():
	user_id = get_jwt_identity()
	random_question = (
		Question.query.filter(~Question.answers.any(Answer.source == "expert"))
		.order_by(db.func.random())
		.first()
	)

	if random_question:
		question_data = {
			"id": random_question.id,
			"sentence": random_question.sentence,
			"language": random_question.language,
			"created_at": random_question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
			"topics": random_question.topic,
			"sub_topic": random_question.sub_topic,
			"category": random_question.category,
			"animal_crop": random_question.animal_crop,
			"location": random_question.location,
		}
		return jsonify(question_data), HTTP_200_OK
	else:
		return jsonify({"message": "No questions available."}), HTTP_404_NOT_FOUND


@questions.route("/main_question_review", methods=["POST"])
@jwt_required()
def main_question_review():

	sub_category_map = {
    "poultry": ["chicken", "ducks", "guinea fowls", "turkeys"],
    "vegetables":  [
			"tomatoes", "carrots", "onions", "mushrooms", "eggplant", "beetroot",
			"doodo", "spinach", "cucumbers", "avocado", "cabbage", "nakati", "ginger",
			"green pepper", "garlic", "okra", "lettuce", "malakwang", "pepper", "sukuma wiiki",
			"kale", "hubiscus", "crops", "crop"
		],
		"cattle": ["cattle", "goat", "goats", "sheep"],
		"fish": ["fish", 'Fish'],
		"banana": ["banana", "bananas", "crop", "crops"],
		"fruits": ["watermelon", "pineapple", "mango", "sugarcane", "orange", "avocado", "passion fruit", "jack fruit", "paw paw", "guava", "lemon"],
		"cereals": ["maize", "sorghum", "millet", "rice", "wheat", "sim sim", "sesame"],
		"legumes": [ "soya beans", "beans", "peas", "groundnuts", "Gnuts", "ground nuts"],
		"piggery": ["pigs", 'animal', 'animals']
  }

	data = request.get_json()
	
	category = data.get("category", None)
	language = data.get("language", None)
	sub_category = data.get("sub_category", None)
	new_category = data.get("new_category", None)

	filters = []

	expert_id = get_jwt_identity()

	category_filter = func.lower(Question.category) == category
	answers_count = Answer.query.filter_by(user_id=expert_id).count()
	sub_categories = [sc.strip().lower() for sc in new_category.split(",")]

	if len(sub_categories) >= 3 and answers_count >= 350:
		return jsonify({"message":"You have answered enough questions. START ranking."}), HTTP_200_OK
	elif len(sub_categories) < 3 and answers_count >= 250:
		return jsonify({"message":"You have answered enough questions. START ranking."}), HTTP_200_OK
	else:
		if language:
			languages = [lang.strip().lower() for lang in language.split(",")]
			language_filter = func.lower(Question.language).in_(languages)
			filters.append(language_filter)

		if sub_category:
			sub_category_filters = []
			
			for sub_category_name in sub_categories:
				sub_category_list = sub_category_map.get(sub_category_name)
				if sub_category_list:
					sub_category_filters.append( func.lower(Question.animal_crop).in_(sub_category_list))
				else:
					sub_category_filters.append(func.lower(Question.animal_crop) == sub_category_name)
			
			if sub_category_filters:
				filters.append(or_(*sub_category_filters))

	matching_questions = (
		Question.query.filter(Question.rephrased == "actual", Question.answered.is_(False), *filters)
		.all()
	)

	if matching_questions:
		random_question = random.sample(matching_questions, 1)[0]
		questions_data = format_question(random_question, "Any Language")
		return jsonify([questions_data]), HTTP_200_OK
	else:
		return jsonify({"message": "No questions available."}), HTTP_404_NOT_FOUND


@jwt_required()
@questions.route("/main_question_answer", methods=["POST"])
def main_question_answer():
	data = request.get_json()

	category = (data.get("category", None)).title()
	language = data.get("language", None)
	sub_category = data.get("sub_category", None)
	new_category = data.get("new_category", None)
	filters = []
	if language:
		if ',' in language:
			languages = [lang.strip().lower() for lang in language.split(",")]
			language_filter = func.lower(Question.language).in_(languages)
		else:
			language_filter = func.lower(Question.language) == language.strip().lower()
		filters.append(language_filter)
	
	if sub_category:
		sub_category = sub_category.lower()
		if sub_category.lower() == "vegetables":
			
	
			allowed_vegetables = [
				"tomatoes", "carrots", "onions", "mushrooms", "eggplant", 
        "beetroot", "doodoo", "spinach", "cucumbers", "avocado", 
        "cabbage", "nakati", "ginger", "green pepper", "garlic", 
        "okra", "lettuce", "malakwang", "pepper"
				]
			if ',' in sub_category:
				sub_categories = [lang.strip().lower() for lang in sub_category.split(",")]
				sub_category_filter = func.lower(Question.animal_crop).in_(sub_categories)
				sub_category_filter = and_(sub_category_filter, func.lower(Question.animal_crop).in_(allowed_vegetables))
			else:
				sub_category_filter = func.lower(Question.animal_crop).in_(allowed_vegetables)
		else:
			if ',' in sub_category:
				sub_categories = [lang.strip().lower() for lang in sub_category.split(",")]
				sub_category_filter = func.lower(Question.animal_crop).in_(sub_categories)
			else:
				sub_category_filter = func.lower(Question.animal_crop) == sub_category.strip().lower()
		filters.append(sub_category_filter)


	matching_questions = Question.query.filter(
		Question.category.ilike(category),
		Question.rephrased == "actual",
    Question.reviewed == True,
    Question.answered.is_not(True),
		*filters
		).order_by(db.func.random()).first()

	if matching_questions is not None:
		return jsonify(jsonify_question(matching_questions)), HTTP_200_OK
	else:
		return jsonify({"message": "No questions available."}), HTTP_404_NOT_FOUND


@questions.post("/add_answer/<int:question_id>")
@jwt_required()
def add_answer(question_id):
	data = request.get_json()
	user_id = get_jwt_identity()
	answer_text = request.json["answer"].strip()

	question = Question.query.get(question_id)
	if not question:
		return jsonify({"message": "Question not found."}), HTTP_404_NOT_FOUND

	if answer_text and len(answer_text) > 7:
		new_answer = Answer(
			question_id=question_id,
			user_id=user_id,
			answer_text=answer_text,
			source="expert",
		)

		db.session.add(new_answer)
		question.answered = True
		question.answer_expert_one = user_id
		db.session.commit()

		return jsonify({"message": "Answer added successfully."}), HTTP_201_CREATED
	return jsonify({"message": "Failed to add answer."})

@questions.post("/review_and_answer/<int:question_id>")
@jwt_required()
def review_and_answer(question_id):
	user_id = get_jwt_identity()
	question = Question.query.get(question_id)

	if not question:
		return jsonify({"message": "Question not found."}), HTTP_404_NOT_FOUND

	data = request.get_json()
	answer_text = data.get("answer", "").strip()
	new_topic = data.get("topic")

	if answer_text and len(answer_text) > 4:
		new_answer = Answer(
				question_id=question_id,
				user_id=user_id,
				answer_text=answer_text,
				source="expert",
		)

		db.session.add(new_answer)
		question.answered = True
		question.answer_expert_one = user_id

		if question.topic:
			if new_topic:
				question.topic = (new_topic + ", " + question.topic)
		else:
			question.topic = new_topic

		question.reviewed = True
		question.correct = True
		question.reviewer_id = user_id

		db.session.commit()

		return jsonify({"message": "Answer added successfully and question attributes updated."}), HTTP_201_CREATED

	return jsonify({"message": "Failed to add answer or update question attributes."})

@questions.route("/incorrect/<int:question_id>", methods=["PUT"])
@jwt_required()
def mark_question_as_reviewed(question_id):
	user_id = get_jwt_identity()
	question = Question.query.get(question_id)

	if question:
		question.reviewed = True
		question.correct = False
		question.reviewer_id = user_id

		db.session.commit()

		return jsonify({"message": "Question attributes updated"})
	else:
		return jsonify({"message": "Question not found"})


@questions.route("/question_review/<int:question_id>", methods=["PATCH"])
@jwt_required()
def question_review(question_id):
	user_id = get_jwt_identity()
	question = Question.query.get(question_id)
	
	if question:

		question.reviewed = True
		question.correct = True 
		question.reviewer_id = user_id

		rephrased_data = request.json.get(
			"rephrased"
		)
		if rephrased_data:
			question.sentence = rephrased_data

		new_topic = request.json.get(
			"topic"
		)
		if question.topic:
			if new_topic:
				question.topic = (
					new_topic + ", " + question.topic
				)
		else:
			question.topic = new_topic 

		db.session.commit()

		return jsonify({"message": "Question attributes updated"})
	else:
		return jsonify({"message": "Question not found"})


@questions.route("/random_unanswered_question", methods=["GET"])
@jwt_required()
def get_random_unanswered_question():
	user_id = get_jwt_identity()

	# Get a random unanswered question for the user
	random_questions = Question.query.filter(
		Question.rephrased == "actual",
    Question.reviewed == True,
    Question.answered.is_not(True),
		Question.user_id == user_id
	).all()
	print(len(random_questions))
	questions_data = []
	if random_questions:
		for random_question in random_questions:
			question_data = {
				"id": random_question.id,
				"sentence": random_question.sentence,
				"language": random_question.language,
				"category": random_question.category,
				"sub_topic": random_question.animal_crop,
				"location": random_question.location,
				# "sub_topic": random_question.sub_topic,
			}
			questions_data.append(question_data)
		return jsonify(questions_data), 200
	else:
		return jsonify({"message": "No unanswered questions available"}), 404


@questions.route("/luganda", methods=["GET"])
@jwt_required()
def get_luganda_questions():
	luganda_questions = Question.query.filter(
		(Question.rephrased != "actual"),
		(Question.cleaned.is_(None) | (Question.cleaned != "t"))
		& (func.lower(Question.language) == "luganda")
	).all()

	if luganda_questions:
		questions_data = []
		for question in luganda_questions:
			question_data = {
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"cleaned": question.cleaned,
			}
			questions_data.append(question_data)

		return jsonify(questions_data), HTTP_200_OK
	else:
		return jsonify({"message": "No Luganda questions found"}), HTTP_404_NOT_FOUND


@questions.route("/english", methods=["GET"])
@jwt_required()
def get_english_questions():
	english_questions = Question.query.filter(
		(Question.rephrased != "actual"),
		(Question.cleaned.is_(None) | (Question.cleaned != "t"))
		& (func.lower(Question.language) == "english")
	).all()

	if english_questions:
		questions_data = []
		for question in english_questions:
			question_data = {
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"cleaned": question.cleaned,
			}
			questions_data.append(question_data)

		return jsonify(questions_data), HTTP_200_OK
	else:
		return jsonify({"message": "No Luganda questions found"}), HTTP_404_NOT_FOUND
	
@questions.route("/runyankole", methods=["GET"])
@jwt_required()
def get_runyankole_questions():
	verify_jwt_in_request()
	current_user = get_jwt_identity()
	is_admin = User.query.get(current_user)

	runya_questions = (Question.query
	.filter(Question.user_id != is_admin.id)
	.filter(func.lower(Question.language) == "runyankole")
	.all())


	if runya_questions:
		questions_data = []
		for question in runya_questions:
			question_data = {
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"cleaned": question.cleaned,
			}
			questions_data.append(question_data)

		return jsonify(questions_data), HTTP_200_OK
	else:
		return jsonify({"message": "No Runyankole questions found"}), HTTP_404_NOT_FOUND
	
@questions.route("/audios", methods=["GET"])
@jwt_required()
def audio_questions():
	
	audio_questions_list = []

	# for filename in allaudios:
	# 	question_detail = Question.query.filter(func.lower(Question.filename) == filename.lower()).first()

	# 	if question_detail:
	# 		user = User.query.get(question_detail.user_id)
	# 		if user:
	# 			user_name = f"{user.firstname} {user.lastname}"
     
	# 		audio_questions_list.append({
	# 			'id': question_detail.id,
	# 			"language": question_detail.language,
	# 			"created_at": question_detail.created_at.strftime("%Y-%m-%d %H:%M:%S"),
	# 			"topics": question_detail.topic,
	# 			"sub_topic": question_detail.sub_topic,
	# 			"category": question_detail.category,
	# 			"animal_crop": question_detail.animal_crop,
	# 			"location": question_detail.location,
	# 			'filename': question_detail.filename,
	# 			'username': user_name,
	# 			# 'file_content': get_audio_file_content(file_path)
	# 		})
	# 		print(len(audio_questions_list))
	# if len(audio_questions_list) > 0:
	# 	return jsonify(audio_questions_list)
	# else:
	return jsonify({"message": "No Audio questions found"}), HTTP_404_NOT_FOUND

@questions.route("/expertluganda", methods=["GET"])
@jwt_required()
def get_expert_luganda_questions():
	luganda_questions = Question.query.filter(
		(Question.rephrased == "actual")
		& (func.lower(Question.language) == "luganda")
	).all()

	if luganda_questions:
		questions_data = []
		for question in luganda_questions:
			question_data = {
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
			}
			questions_data.append(question_data)

		return jsonify(questions_data), HTTP_200_OK
	else:
		return jsonify({"message": "No Luganda expert questions found"}), HTTP_404_NOT_FOUND
	
@questions.route("/expertenglish", methods=["GET"])
@jwt_required()
def get_expert_english_questions():
	luganda_questions = Question.query.filter(
		(Question.rephrased == "actual")
		& (func.lower(Question.language) == "english")
	).all()

	if luganda_questions:
		questions_data = []
		for question in luganda_questions:
			question_data = {
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
			}
			questions_data.append(question_data)

		return jsonify(questions_data), HTTP_200_OK
	else:
		return jsonify({"message": "No English expert questions found"}), HTTP_404_NOT_FOUND
	
@questions.route("/expertrunyankole", methods=["GET"])
@jwt_required()
def get_expert_runyankole_questions():
	luganda_questions = Question.query.filter(
		(Question.rephrased == "actual")
		& (func.lower(Question.language) == "runyankole")
	).all()

	if luganda_questions:
		questions_data = []
		for question in luganda_questions:
			question_data = {
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topics": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
			}
			questions_data.append(question_data)

		return jsonify(questions_data), HTTP_200_OK
	else:
		return jsonify({"message": "No Runyankole expert questions found"}), HTTP_404_NOT_FOUND

@questions.route("/evaluated", methods=["GET"])
@jwt_required()
def get_evaluated_questions():
	
	matching_questions = (
		Question.query.filter(
			Question.ranking_count == 2)
		.all()
	)
	total_questions = len(matching_questions)
	print(total_questions)

	if matching_questions:
		questions_data = []
		for question in matching_questions:
			question_data = {
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"created_at": question.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				"topic": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"answers": []
			}

			for answer in question.answers:
				answer_data = {
					"id": answer.id,
					"answer_text": answer.answer_text,
					"source": answer.source,
					"relevance": answer.relevance,
					"coherence": answer.coherence,
					"fluency": answer.fluency,
					"context": answer.context,
					"created_at": answer.created_at.strftime("%Y-%m-%d %H:%M:%S"),
				}
				question_data["answers"].append(answer_data)

			questions_data.append(question_data)

		result_object = {
				"questions": questions_data,
				"total_questions": total_questions
		}
		print(len(question_data))
		return jsonify(result_object), HTTP_200_OK
	else:
		return jsonify({"message": "No questions available for ranking."}), HTTP_404_NOT_FOUND

@questions.route("/cleaning", methods=["GET"])
@jwt_required()
def clean_evaluated_questions():
	matching_questions = Question.query.filter(Question.ranking_count == 2).all()
	if matching_questions:
		for entry in matching_questions:
			for answer in entry.answers:
				if answer.relevance > 10:
					sum_of_digits = sum(int(digit) for digit in str(answer.relevance))
					answer.relevance = sum_of_digits
				if answer.coherence > 10:
					sum_of_digits = sum(int(digit) for digit in str(answer.coherence))
					answer.coherence = sum_of_digits
				if answer.fluency > 10:
					sum_of_digits = sum(int(digit) for digit in str(answer.fluency))
					answer.fluency = sum_of_digits
		db.session.commit()
		return jsonify({"message": "Values updated successfully."}), HTTP_200_OK
	else:
			return jsonify({"message": "No questions available for cleaning."}), HTTP_404_NOT_FOUND

@questions.route("/dataset_upload/", methods=["POST"])
@jwt_required()
def upload_excel_file():
	if request.method == "POST":
		file_excel = request.files.get("file")

		if file_excel and file_excel.filename.endswith(".xlsx"):
			try:
				# Read the Excel file using pandas
				df = pd.read_excel(file_excel)

				current_user = get_jwt_identity()
				dup_count = 0
				duplicates = []

				for _, row in df.iterrows():
					sentence = row.get("sentence")
					language = row.get("language")
					topic = row.get("topics", None)
					category = row.get("category", None)
					animal_crop = row.get("crop_animal", None)
					location = row.get("location", None)

					if Question.query.filter_by(sentence=sentence).first():
						dup_count += 1
						duplicates.append({"sentence": sentence})
					else:
						question = Question(
							sentence=sentence,
							language=language,
							user_id=current_user,
							topic=topic,
							category=category,
							animal_crop=animal_crop,
							location=location,
						)
						db.session.add(question)

				db.session.commit()

				num_questions = Question.query.filter_by(user_id=current_user).count()

				return (
					jsonify(
						{
							"num_questions": num_questions,
							"duplicate_questions": dup_count,
							"duplicates": duplicates,
						}
					),
					HTTP_200_OK,
				)
			except Exception as e:
				return jsonify({"message": str(e)}), HTTP_400_BAD_REQUEST
		else:
			return (
				jsonify(
					{"message": "Invalid file format. Please upload a .xlsx file."}
				),
				HTTP_400_BAD_REQUEST,
			)

@questions.route("/main_question_rank", methods=["POST"])
@jwt_required()
def main_question_rank():
	sub_category_map = {
    "poultry": ["chicken", "ducks", "guinea fowls", "turkeys"],
    "vegetables":  [
			"tomatoes", "carrots", "onions", "mushrooms", "eggplant", "beetroot",
			"doodo", "spinach", "cucumbers", "avocado", "cabbage", "nakati", "ginger",
			"green pepper", "garlic", "okra", "lettuce", "malakwang", "pepper", "sukuma wiiki",
			"kale", "hubiscus", "crops", "crop"
		],
		"cattle": ["cattle", "goat", "goats", "sheep"],
		"fish": ["fish", 'Fish'],
		"banana": ["banana", "bananas", "crop", "crops"],
		"fruits": ["watermelon", "pineapple", "mango", "sugarcane", "orange", "avocado", "passion fruit", "jack fruit", "paw paw", "guava", "lemon"],
		"cereals": ["maize", "sorghum", "millet", "rice", "wheat", "sim sim", "sesame"],
		"legumes": [ "soya beans", "beans", "peas", "groundnuts", "Gnuts", "ground nuts"],
		"piggery": ["pigs", 'animal', 'animals']
  }

	data = request.get_json()
	
	category = (data.get("category", None)).title()
	language = data.get("language", None)
	sub_category = data.get("sub_category", None)
	new_category = data.get("new_category", None)

	current_user = get_jwt_identity()

	filters = []
	random_question_data = None

	category_filter = func.lower(Question.category) == category

	if language:
		languages = [lang.strip().lower() for lang in language.split(",")]
		language_filter = func.lower(Question.language).in_(languages)
		filters.append(language_filter)

	if sub_category:
		sub_categories = [sc.strip().lower() for sc in new_category.split(",")]
		sub_category_filters = []
		
		for sub_category_name in sub_categories:
			sub_category_list = sub_category_map.get(sub_category_name)
			if sub_category_list:
				sub_category_filters.append( func.lower(Question.animal_crop).in_(sub_category_list))
			else:
				sub_category_filters.append(func.lower(Question.animal_crop) == sub_category_name)
		
		if sub_category_filters:
			filters.append(or_(*sub_category_filters))

	random_question = (
		Question.query.filter(
			Question.rephrased == "actual",
    	Question.answered.is_(True),
    	Question.finished.is_not(True),
			(~Question.answers.any(Answer.user_id == current_user)),
			Question.rank_expert_one != current_user,
			Question.ranking_count < 2,
			*filters)
		.all()
	)

	matching_questions = None
	if random_question:
		partial_ranked_qns = [q for q in random_question if q.ranking_count == 1]

		if partial_ranked_qns:
			matching_questions = random.sample(partial_ranked_qns, 1)[0]
		else:
			matching_questions = random.sample(random_question, 1)[0]
	
	if matching_questions:
		random_question_data = {
			"id": matching_questions.id,
			"sentence": matching_questions.sentence,
			"language": matching_questions.language,
			"created_at": matching_questions.created_at.strftime("%Y-%m-%d %H:%M:%S"),
			"topic": matching_questions.topic,
			"sub_topic": matching_questions.sub_topic,
			"category": matching_questions.category,
			"animal_crop": matching_questions.animal_crop,
			"location": matching_questions.location,
			"filename": matching_questions.filename,
		}

	    # Create a list to store answer data for each associated answer
		answer_list = []
		for answer in matching_questions.answers:
			answer_data = {
				"id": answer.id,
				"answer_text": answer.answer_text,
				"source": answer.source,
				"relevance": answer.relevance,
				"coherence": answer.coherence,
				"fluency": answer.fluency,
				"rank": answer.rank,
				"created_at": answer.created_at.strftime("%Y-%m-%d %H:%M:%S"),
			}
			answer_list.append(answer_data)

		random_question_data["answers"] = answer_list

	if random_question_data:
		result_object = {"random_question_data": random_question_data}
		return jsonify(result_object), HTTP_200_OK
	else:
		return jsonify({"message": "No questions available for ranking."}), HTTP_404_NOT_FOUND
	
def upload_to_bucket(bucket_name, source_file_name, destination_blob_name):
    """Uploads a file to a GCP storage bucket."""
    storage_client = storage.Client()
    bucket = storage_client.bucket(bucket_name)
    blob = bucket.blob(destination_blob_name)
    blob.upload_from_filename(source_file_name)
    print(f"File {source_file_name} uploaded to {destination_blob_name} in bucket {bucket_name}.")

	
@questions.route("/fetch_questions", methods=["GET"])
@jwt_required()
def fetch_questions():
	page = request.args.get('page', 1, type=int)
	per_page = request.args.get('per_page', 50, type=int)

	matching_questions = (
		Question.query.filter(
			Question.rephrased == "actual",
    	Question.reviewed == False
			)
		.paginate(page=page, per_page=per_page, error_out=False)
	)
	all = []
	random_question_data = None
	if matching_questions:
		for question in matching_questions:
			answers = [{'text': answer.answer_text, 'source': answer.source} for answer in question.answers]

			random_question_data = {
				"id": question.id,
				"sentence": question.sentence,
				"language": question.language,
				"topic": question.topic,
				"sub_topic": question.sub_topic,
				"category": question.category,
				"animal_crop": question.animal_crop,
				"location": question.location,
				"answers": answers
			}
			all.append(random_question_data)

	if all:
		pagination_details = {
			'total_pages': matching_questions.pages,
			'current_page': matching_questions.page,
			'per_page': per_page,
			'total_questions': matching_questions.total
    }

		return jsonify({'questions': all, 'pagination': pagination_details}), HTTP_200_OK
	else:
		return jsonify({"message": "No questions available."}), HTTP_404_NOT_FOUND


@questions.route("/store_answer_ranks", methods=["POST"])
@jwt_required()
def store_answer_ranks():
	user_id = get_jwt_identity()
	data = request.json
	question_id = data.get("questionId")
	rankings = data.get("rankings")

	if question_id is None or rankings is None:
		return jsonify({"message": "Invalid data format"}), HTTP_400_BAD_REQUEST

	question = Question.query.get(question_id)

	if question is None:
		return jsonify({"error": "Question not found"}), HTTP_404_NOT_FOUND

	ranking_count = 0
	try:
		for ranking in rankings:
			answer_id = ranking.get("answer_id")
			answer = Answer.query.get(answer_id)

			if answer:
				relevance = answer.relevance if answer.relevance is not None else 0
				coherence = answer.coherence if answer.coherence is not None else 0
				fluency = answer.fluency if answer.fluency is not None else 0
				
				relevance = relevance + chanelle(ranking.get("relevance"))
				coherence = coherence + chanelle(ranking.get("coherence"))
				fluency = fluency + chanelle(ranking.get("fluency"))
				
				# answer.context = ranking.get("context")
				if ranking.get("isFlagged"):
					answer.offensive = True

				answer.relevance = relevance
				answer.coherence = coherence
				answer.fluency = fluency
				answer.context = ranking.get("context")


		if question:
			if question.rank_expert_one is None:
				question.rank_expert_one = user_id
				question.ranking_count = 1
			else:
				question.rank_expert_two = user_id
				question.ranking_count = 2

			ranking_count += 1

		if ranking_count == 2 or question.ranking_count == 2:
			question.finished = True

		db.session.commit()
		return jsonify({"message": "Answer ranks stored successfully"}), HTTP_200_OK

	except Exception as e:
		db.session.rollback()
		return jsonify({"message": "Error storing answer ranks"}), HTTP_400_BAD_REQUEST


@questions.route("/expert-stats", methods=["GET"])
@jwt_required()
def question_stats():
	total_cleaned = Question.query.filter_by(cleaned=True, rephrased="actual").count()
	cleaned_and_reviewed = Question.query.filter_by(cleaned=True, reviewed=True, rephrased="actual").count()
	cleaned_reviewed_and_answered = Question.query.filter_by(
		cleaned=True, answered=True, rephrased="actual"
	).count()
	all_fields_true = Question.query.filter_by(cleaned=True, finished=True, rephrased="actual").count()
	experts = User.query.filter_by(role="expert").all()
	english_questions = Question.query.filter(
		Question.rephrased == "actual",
		Question.language.ilike("english")
	).count()
	luganda_questions = Question.query.filter(
		Question.rephrased == "actual",
		Question.language.ilike("luganda")
	).count()
	runyankole_questions = Question.query.filter(
		Question.rephrased == "actual",
		Question.language.ilike("runyankole")
	).count()

	fully_ranked = Question.query.filter(Question.ranking_count == 2).count()
	partial_ranked = Question.query.filter(Question.ranking_count == 1).count()

	expert_data = []
	for expert in experts:
		reviewed_questions_count = Question.query.filter_by(
			reviewer_id=expert.id
		).count()
		answers = Answer.query.filter_by(user_id=expert.id).count()

		ranked_answers = Question.query.filter((Question.rank_expert_one == expert.id) | (Question.rank_expert_two == expert.id)).count()

		expert_info = {
			"id": expert.id,
			"lastname": expert.lastname,
			"firstname": expert.firstname,
			"phone_number": expert.phone_number,
			"reviewed_questions_count": reviewed_questions_count,
			"answers_count": answers,
			"ranked_answers": ranked_answers,
			"language": expert.language,
			"expertise": expert.category,
			"sub_category": expert.sub_category,
			"new_category": expert.new_category,
			"created_at": expert.created_at,
		}

		expert_data.append(expert_info)

	return jsonify(
		{
			"total_cleaned": total_cleaned,
			"cleaned_and_reviewed": cleaned_and_reviewed,
			"cleaned_reviewed_and_answered": cleaned_reviewed_and_answered,
			"all_fields_true": all_fields_true,
			"experts": expert_data,
			"english_questions": english_questions,
			"luganda_questions": luganda_questions,
			"runyankole_questions": runyankole_questions,
			"fully_ranked": fully_ranked,
			"partial_ranked": partial_ranked
		}
	)


@questions.route("/user_answers", methods=["GET"])
@jwt_required()
def get_user_answers():
	user_id = get_jwt_identity()

	reviewed_questions_count = Question.query.filter_by(
		reviewer_id=user_id
	).count()

	questions_count = Question.query.filter(
		Question.answer_expert_one == user_id
	).count()

	answers = Answer.query.filter_by(user_id=user_id).count()

	ranked_answers = Question.query.filter((Question.rank_expert_one == user_id) | (Question.rank_expert_two == user_id)).count()

	user_answers = Answer.query.filter_by(user_id=user_id).all()
	answers_data = []

	for answer in user_answers:
		question = answer.question
		
		answers_data.append(
			{
				"id": answer.id,
				"answer_text": answer.answer_text,
				"created_at": answer.created_at,
				"question_id": answer.question_id,
				"sentence": question.sentence,
				"rank": question.ranking_count
			}
		)
	return jsonify({"questions_count":questions_count, "all_answers":answers_data, "answers": answers,"reviewed_questions": reviewed_questions_count,"ranked": ranked_answers})


@questions.route("/answers/<int:answer_id>", methods=["GET"])
@jwt_required()
def get_answer(answer_id):
	user_id = get_jwt_identity()


	answer = Answer.query.get(answer_id)
	if not answer:
		return jsonify({"error": "Answer not found"}), HTTP_404_NOT_FOUND

	if answer.user_id != user_id:
		return jsonify({"error": "Unauthorized access to answer details"}), 403

	question = Question.query.get(answer.question_id)
	if not question:
		return jsonify({"error": "Question not found"}), HTTP_404_NOT_FOUND

	response_data = {
		"answer_id": answer.id,
		"answer_text": answer.answer_text,
		"question_id": question.id,
		"question_text": question.sentence,
		"language": question.language,
		"animal_crop": question.animal_crop,
		"category": question.category,
		"topic": question.topic,
		"sub_topic": question.sub_topic,
	
	}

	return jsonify(response_data), HTTP_200_OK


@questions.route("/experts/<int:user_id>", methods=["GET"])
@jwt_required()
def get_expert_stats(user_id):
	answers = Answer.query.filter_by(user_id=user_id).all()
	if not answers:
		return jsonify({"error": "Answers not found"}), HTTP_404_NOT_FOUND

	answers_data = []
	for answer in answers:
		
		question = Question.query.get(answer.question_id)
		answers_data.append(
			{
				"answer_id": answer.id,
				"answer_text": answer.answer_text,
				"date": answer.created_at,
				"question_id": question.id,
				"question_text": question.sentence,
				"language": question.language,
				"animal_crop": question.animal_crop,
				"category": question.category,
				"topic": question.topic,
				"sub_topic": question.sub_topic,
			
			}
		)

	return jsonify(answers_data), HTTP_200_OK

@questions.route("/update_answer_text/<int:answer_id>", methods=["PUT"])
@jwt_required()
def update_answer_text(answer_id):
	answer = Answer.query.get(answer_id)
	if not answer:
		return jsonify({"message": "Answer not found"}), HTTP_404_NOT_FOUND
	new_answer_text = request.json.get("answer_text")

	if not new_answer_text:
		return jsonify({"message": "New answer_text not provided"}), HTTP_404_NOT_FOUND

	answer.answer_text = new_answer_text
	db.session.commit()

	return jsonify({"message": "Answer text updated successfully"}), HTTP_200_OK


@questions.route("/upload_json_answers/", methods=["GET"])
@jwt_required()
def upload_json_answers():

	current_user_id = get_jwt_identity()
	dup_count = 0
	duplicates = []

	for obj in embedded_json:
		sentence = obj.get("Questions")
		language = obj.get("language")
		topic = obj.get("Topics")
		sub_topic = obj.get("Sub topics")
		category = obj.get("Category")
		animal_crop = obj.get("animal_crop")
		location = obj.get("Location")

		# Check if the question already exists
		existing_qn = Question.query.filter_by(sentence=sentence, cleaned=True, rephrased="actual").first()
		if existing_qn:
				dup_count += 1
				duplicates.append({"sentence": sentence})
				existing_qn.animal_crop = animal_crop
				db.session.commit()

		else:
				question = Question(
						sentence=sentence,
						language=language,
						user_id=current_user_id,
						topic=topic,
						sub_topic=sub_topic,
						category=category,
						animal_crop=animal_crop,
						location=location,
						cleaned=True,
						rephrased="actual",
						reviewed=True,
						reviewer_id=1
				)
				db.session.add(question)
				db.session.commit()
				question_id = question.id

				response_categories = [
						"Llama2",
						"Bard",
						"Bing",
						"ChatGPT 3.5",
						"GPT 4",
				]
				for category in response_categories:
						response_value = obj.get(category)
						if response_value is not None:
								response = Answer(
										question_id=question_id,
										answer_text=response_value,
										source=category,
										user_id=current_user_id,
								)
								db.session.add(response)
								db.session.commit()

	response_data = {"duplicates_count": dup_count, "duplicates": duplicates}
	return jsonify(response_data), HTTP_200_OK


@questions.route("/issues", methods=["GET"])
@jwt_required()
def get_debug_answers():
	user_id = get_jwt_identity()
	updated_items = []
	list_of_lists = []
	oldpa =[]
	for item in oldpa:
		item_id = item['id']
		db_item = Answer.query.get(item_id)
		
		if db_item:
			list_of_lists.append([item, {
				'id': db_item.id,
				'coherence': db_item.coherence,
				'relevance': db_item.relevance,
				'fluency': db_item.fluency
			}])
			
	
	return jsonify({
		'updated_items': list_of_lists
	})


@questions.route("/expertsanswers", methods=["GET"])
@jwt_required()
def get_experts_and_answers():
	experts = User.query.filter_by(role='expert').all()
	experts_data = []
	
	for expert in experts:
		expert_data = {
			'id': expert.id,
			'username': expert.username,
			'expertise': expert.new_category,
			'answers': []
			}
		answers = Answer.query.filter_by(user_id=expert.id).all()
		
		for answer in answers:
			answer_data = {
				'id': answer.id,
				'question_id': answer.question_id,
				'answer_text': answer.answer_text,
				}
			expert_data['answers'].append(answer_data)
		experts_data.append(expert_data)

	return jsonify(experts_data)


@questions.route("/addexcelanswers", methods=["GET"])
@jwt_required()
def add_excel_answers():
	for expert, expert_data in list_of_expertiz.items():
		print(expert)
		user_id = expert_data['id']
		print(user_id)
		
		user = User.query.get(user_id)
		
		if user is None:
			return jsonify({'message': f'User with ID {user_id} not found'}), 404
		
		expert_answers = derek_list.get(expert, [])
		for answer_data in expert_answers:
			
			question_id = answer_data.get('Question_id')
			answer_text = answer_data.get('Answer')

			existing_question = Question.query.filter_by(id=question_id).first()
			if existing_question:
				new_answer = Answer(
						question_id=question_id,
						user_id=user_id,
						answer_text=answer_text,
						source="expert"
				)
				db.session.add(new_answer)
				existing_question.answered = True
				existing_question.answer_expert_one = user_id
				existing_question.reviewed = True
				existing_question.correct = True
				existing_question.reviewer_id = user_id
	
			db.session.commit()
	
	return jsonify({'message': 'Answers updated successfully'}), 200
